<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>egrecho.core.module &mdash; egrecho  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=649a27d8" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx_paramlinks.css" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=b3ba4146"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
        <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../../_static/copybutton.js?v=4ea706d9"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="egrecho.core.optimization" href="optimization.html" />
    <link rel="prev" title="egrecho.core.loads" href="loads.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            egrecho
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">egrecho.core</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="config.html">egrecho.core.config</a><ul>
<li class="toctree-l3"><a class="reference internal" href="config.html#egrecho.core.config.DataclassConfig"><code class="docutils literal notranslate"><span class="pre">DataclassConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="config.html#egrecho.core.config.DataclassConfig.from_config"><code class="docutils literal notranslate"><span class="pre">from_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="config.html#egrecho.core.config.DataclassConfig.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="data_builder.html">egrecho.core.data_builder</a><ul>
<li class="toctree-l3"><a class="reference internal" href="data_builder.html#egrecho.core.data_builder.DataBuilderConfig"><code class="docutils literal notranslate"><span class="pre">DataBuilderConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="data_builder.html#egrecho.core.data_builder.DataBuilderConfig.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data_builder.html#egrecho.core.data_builder.DataBuilder"><code class="docutils literal notranslate"><span class="pre">DataBuilder</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="data_builder.html#egrecho.core.data_builder.DataBuilder.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_builder.html#egrecho.core.data_builder.DataBuilder.from_config"><code class="docutils literal notranslate"><span class="pre">from_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_builder.html#egrecho.core.data_builder.DataBuilder.save_config"><code class="docutils literal notranslate"><span class="pre">save_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_builder.html#egrecho.core.data_builder.DataBuilder.dump_config"><code class="docutils literal notranslate"><span class="pre">dump_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_builder.html#egrecho.core.data_builder.DataBuilder.build_dataset"><code class="docutils literal notranslate"><span class="pre">build_dataset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_builder.html#egrecho.core.data_builder.DataBuilder.build_single_dataset"><code class="docutils literal notranslate"><span class="pre">build_single_dataset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_builder.html#egrecho.core.data_builder.DataBuilder.data_files"><code class="docutils literal notranslate"><span class="pre">data_files</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_builder.html#egrecho.core.data_builder.DataBuilder.estimate_length"><code class="docutils literal notranslate"><span class="pre">estimate_length()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_builder.html#egrecho.core.data_builder.DataBuilder.num_classes"><code class="docutils literal notranslate"><span class="pre">num_classes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_builder.html#egrecho.core.data_builder.DataBuilder.class_label"><code class="docutils literal notranslate"><span class="pre">class_label</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_builder.html#egrecho.core.data_builder.DataBuilder.feature_extractor"><code class="docutils literal notranslate"><span class="pre">feature_extractor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_builder.html#egrecho.core.data_builder.DataBuilder.feature_size"><code class="docutils literal notranslate"><span class="pre">feature_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_builder.html#egrecho.core.data_builder.DataBuilder.inputs_dim"><code class="docutils literal notranslate"><span class="pre">inputs_dim</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="feature_extractor.html">egrecho.core.feature_extractor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="feature_extractor.html#egrecho.core.feature_extractor.BaseFeature"><code class="docutils literal notranslate"><span class="pre">BaseFeature</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="feature_extractor.html#egrecho.core.feature_extractor.BaseFeature.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="feature_extractor.html#egrecho.core.feature_extractor.BaseFeature.get_extractor_dict"><code class="docutils literal notranslate"><span class="pre">get_extractor_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="feature_extractor.html#egrecho.core.feature_extractor.BaseFeature.from_dict"><code class="docutils literal notranslate"><span class="pre">from_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="feature_extractor.html#egrecho.core.feature_extractor.BaseFeature.to_dict"><code class="docutils literal notranslate"><span class="pre">to_dict()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="loads.html">egrecho.core.loads</a><ul>
<li class="toctree-l3"><a class="reference internal" href="loads.html#egrecho.core.loads.save_ckpt_conf_dir"><code class="docutils literal notranslate"><span class="pre">save_ckpt_conf_dir()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="loads.html#egrecho.core.loads.ResolveModelResult"><code class="docutils literal notranslate"><span class="pre">ResolveModelResult</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="loads.html#egrecho.core.loads.ResolveModelResult.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="loads.html#egrecho.core.loads.resolve_pretrained_model"><code class="docutils literal notranslate"><span class="pre">resolve_pretrained_model()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="loads.html#egrecho.core.loads.load_module_class"><code class="docutils literal notranslate"><span class="pre">load_module_class()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="loads.html#egrecho.core.loads.load_model_type"><code class="docutils literal notranslate"><span class="pre">load_model_type()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="loads.html#egrecho.core.loads.load_extractor_type"><code class="docutils literal notranslate"><span class="pre">load_extractor_type()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">egrecho.core.module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#egrecho.core.module.TopVirtualModel"><code class="docutils literal notranslate"><span class="pre">TopVirtualModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#egrecho.core.module.TopVirtualModel.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#egrecho.core.module.TopVirtualModel.setup"><code class="docutils literal notranslate"><span class="pre">setup()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#egrecho.core.module.TopVirtualModel.training_step"><code class="docutils literal notranslate"><span class="pre">training_step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#egrecho.core.module.TopVirtualModel.validation_step"><code class="docutils literal notranslate"><span class="pre">validation_step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#egrecho.core.module.TopVirtualModel.pipeline_out"><code class="docutils literal notranslate"><span class="pre">pipeline_out()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#egrecho.core.module.TopVirtualModel.on_train_start"><code class="docutils literal notranslate"><span class="pre">on_train_start()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#egrecho.core.module.TopVirtualModel.on_train_end"><code class="docutils literal notranslate"><span class="pre">on_train_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#egrecho.core.module.TopVirtualModel.configure_optimizers"><code class="docutils literal notranslate"><span class="pre">configure_optimizers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#egrecho.core.module.TopVirtualModel.configure_teacher_callbacks"><code class="docutils literal notranslate"><span class="pre">configure_teacher_callbacks()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#egrecho.core.module.TopVirtualModel.from_pretrained"><code class="docutils literal notranslate"><span class="pre">from_pretrained()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#egrecho.core.module.TopVirtualModel.auto"><code class="docutils literal notranslate"><span class="pre">auto()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#egrecho.core.module.TopVirtualModel.export_onnx"><code class="docutils literal notranslate"><span class="pre">export_onnx()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#egrecho.core.module.TopVirtualModel.export_jit"><code class="docutils literal notranslate"><span class="pre">export_jit()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#egrecho.core.module.DataMoudle"><code class="docutils literal notranslate"><span class="pre">DataMoudle</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#egrecho.core.module.DataMoudle.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#egrecho.core.module.DataMoudle.prepare_data_per_node"><code class="docutils literal notranslate"><span class="pre">prepare_data_per_node</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#egrecho.core.module.DataMoudle.allow_zero_length_dataloader_with_multiple_devices"><code class="docutils literal notranslate"><span class="pre">allow_zero_length_dataloader_with_multiple_devices</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#egrecho.core.module.DataMoudle.setup"><code class="docutils literal notranslate"><span class="pre">setup()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#egrecho.core.module.DataMoudle.setup_data"><code class="docutils literal notranslate"><span class="pre">setup_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#egrecho.core.module.DataMoudle.train_dataset"><code class="docutils literal notranslate"><span class="pre">train_dataset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#egrecho.core.module.DataMoudle.val_dataset"><code class="docutils literal notranslate"><span class="pre">val_dataset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#egrecho.core.module.DataMoudle.test_dataset"><code class="docutils literal notranslate"><span class="pre">test_dataset</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#egrecho.core.model_base.ModuleConfig"><code class="docutils literal notranslate"><span class="pre">ModuleConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#egrecho.core.model_base.ModuleConfig.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#egrecho.core.model_base.ModelBase"><code class="docutils literal notranslate"><span class="pre">ModelBase</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#egrecho.core.model_base.ModelBase.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#egrecho.core.model_base.ModelBase.post_init"><code class="docutils literal notranslate"><span class="pre">post_init()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#egrecho.core.model_base.ModelBase.dummy_inputs"><code class="docutils literal notranslate"><span class="pre">dummy_inputs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#egrecho.core.model_base.ModelBase.export_onnx"><code class="docutils literal notranslate"><span class="pre">export_onnx()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#egrecho.core.model_base.ModelBase.export_jit"><code class="docutils literal notranslate"><span class="pre">export_jit()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="optimization.html">egrecho.core.optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="optimization.html#module-egrecho.core.optimization.optims">optims</a></li>
<li class="toctree-l3"><a class="reference internal" href="optimization.html#module-egrecho.core.optimization.schedulers">schedulers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="parser.html">egrecho.core.parser</a><ul>
<li class="toctree-l3"><a class="reference internal" href="parser.html#egrecho.core.parser.CommonParser"><code class="docutils literal notranslate"><span class="pre">CommonParser</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="parser.html#egrecho.core.parser.CommonParser.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="parser.html#egrecho.core.parser.CommonParser.add_class_args"><code class="docutils literal notranslate"><span class="pre">add_class_args()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="parser.html#egrecho.core.parser.JsnDefaultHelpFormatter"><code class="docutils literal notranslate"><span class="pre">JsnDefaultHelpFormatter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="parser.html#egrecho.core.parser.JsnDefaultHelpFormatter.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="parser.html#egrecho.core.parser.BaseCommand"><code class="docutils literal notranslate"><span class="pre">BaseCommand</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="parser.html#egrecho.core.parser.BaseCommand.get_dummy_parser"><code class="docutils literal notranslate"><span class="pre">get_dummy_parser()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="parser.html#egrecho.core.parser.BaseCommand.setup_parser"><code class="docutils literal notranslate"><span class="pre">setup_parser()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="parser.html#egrecho.core.parser.BaseCommand.run_from_args"><code class="docutils literal notranslate"><span class="pre">run_from_args()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="parser.html#module-egrecho.core.pl_parser">PL Parser</a><ul>
<li class="toctree-l4"><a class="reference internal" href="parser.html#egrecho.core.pl_parser.LightningParser"><code class="docutils literal notranslate"><span class="pre">LightningParser</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="parser.html#egrecho.core.pl_parser.SaveConfigCallback"><code class="docutils literal notranslate"><span class="pre">SaveConfigCallback</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="teacher.html">egrecho.core.teacher</a><ul>
<li class="toctree-l3"><a class="reference internal" href="teacher.html#egrecho.core.teacher.Teacher"><code class="docutils literal notranslate"><span class="pre">Teacher</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="teacher.html#egrecho.core.teacher.Teacher.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="teacher.html#egrecho.core.teacher.Teacher.attach_model"><code class="docutils literal notranslate"><span class="pre">attach_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="teacher.html#egrecho.core.teacher.Teacher.setup"><code class="docutils literal notranslate"><span class="pre">setup()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="teacher.html#egrecho.core.teacher.Teacher.setup_model"><code class="docutils literal notranslate"><span class="pre">setup_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="teacher.html#egrecho.core.teacher.Teacher.setup_loss_fn_dict"><code class="docutils literal notranslate"><span class="pre">setup_loss_fn_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="teacher.html#egrecho.core.teacher.Teacher.setup_train_metrics"><code class="docutils literal notranslate"><span class="pre">setup_train_metrics()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="teacher.html#egrecho.core.teacher.Teacher.setup_val_metrics"><code class="docutils literal notranslate"><span class="pre">setup_val_metrics()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="teacher.html#egrecho.core.teacher.Teacher.training_step"><code class="docutils literal notranslate"><span class="pre">training_step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="teacher.html#egrecho.core.teacher.Teacher.validation_step"><code class="docutils literal notranslate"><span class="pre">validation_step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="teacher.html#egrecho.core.teacher.Teacher.on_train_start"><code class="docutils literal notranslate"><span class="pre">on_train_start()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="teacher.html#egrecho.core.teacher.Teacher.on_train_end"><code class="docutils literal notranslate"><span class="pre">on_train_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="teacher.html#egrecho.core.teacher.Teacher.available_optimizers"><code class="docutils literal notranslate"><span class="pre">available_optimizers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="teacher.html#egrecho.core.teacher.Teacher.available_lr_schedulers"><code class="docutils literal notranslate"><span class="pre">available_lr_schedulers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="teacher.html#egrecho.core.teacher.Teacher.configure_optimizers"><code class="docutils literal notranslate"><span class="pre">configure_optimizers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="teacher.html#egrecho.core.teacher.Teacher.configure_single_optimizer"><code class="docutils literal notranslate"><span class="pre">configure_single_optimizer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="teacher.html#egrecho.core.teacher.Teacher.instantiate_lr_scheduler"><code class="docutils literal notranslate"><span class="pre">instantiate_lr_scheduler()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="teacher.html#egrecho.core.teacher.Teacher.get_lr_scheduler_total_steps_name"><code class="docutils literal notranslate"><span class="pre">get_lr_scheduler_total_steps_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="teacher.html#egrecho.core.teacher.Teacher.configure_teacher_callbacks"><code class="docutils literal notranslate"><span class="pre">configure_teacher_callbacks()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="teacher.html#egrecho.core.teacher.Teacher.estimated_num_steps_per_epoch"><code class="docutils literal notranslate"><span class="pre">estimated_num_steps_per_epoch</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="teacher.html#egrecho.core.teacher.Teacher.get_num_training_steps"><code class="docutils literal notranslate"><span class="pre">get_num_training_steps()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="teacher.html#egrecho.core.teacher.normalize_callable_dict"><code class="docutils literal notranslate"><span class="pre">normalize_callable_dict()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html#egrecho-utils">egrecho.utils</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html">egrecho.utils.apply</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.apply.apply_to_collection"><code class="docutils literal notranslate"><span class="pre">apply_to_collection()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#module-egrecho.utils.common">egrecho.utils.common</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.common.alt_none"><code class="docutils literal notranslate"><span class="pre">alt_none()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.common.is_in_range"><code class="docutils literal notranslate"><span class="pre">is_in_range()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.common.ObjectDict"><code class="docutils literal notranslate"><span class="pre">ObjectDict</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.common.DataclassSerialMixin"><code class="docutils literal notranslate"><span class="pre">DataclassSerialMixin</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.common.DataclassSerialMixin.to_dict"><code class="docutils literal notranslate"><span class="pre">to_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.common.DataclassSerialMixin.from_dict"><code class="docutils literal notranslate"><span class="pre">from_dict()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.common.fields_init_var"><code class="docutils literal notranslate"><span class="pre">fields_init_var()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.common.batched"><code class="docutils literal notranslate"><span class="pre">batched()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.common.camelcase_to_snakecase"><code class="docutils literal notranslate"><span class="pre">camelcase_to_snakecase()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.common.snakecase_to_camelcase"><code class="docutils literal notranslate"><span class="pre">snakecase_to_camelcase()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.common.get_diff_dict"><code class="docutils literal notranslate"><span class="pre">get_diff_dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.common.del_default_dict"><code class="docutils literal notranslate"><span class="pre">del_default_dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.common.dict_union"><code class="docutils literal notranslate"><span class="pre">dict_union()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.common.list2tuple"><code class="docutils literal notranslate"><span class="pre">list2tuple()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#module-egrecho.utils.constants">egrecho.utils.constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#module-egrecho.utils.cuda_utils">egrecho.utils.cuda_utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.cuda_utils.set_to_cuda"><code class="docutils literal notranslate"><span class="pre">set_to_cuda()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.cuda_utils.get_current_device"><code class="docutils literal notranslate"><span class="pre">get_current_device()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.cuda_utils.to_device"><code class="docutils literal notranslate"><span class="pre">to_device()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.cuda_utils.parse_gpus"><code class="docutils literal notranslate"><span class="pre">parse_gpus()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.cuda_utils.parse_gpus_opt"><code class="docutils literal notranslate"><span class="pre">parse_gpus_opt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.cuda_utils.synchronize"><code class="docutils literal notranslate"><span class="pre">synchronize()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.cuda_utils.peak_cuda_memory"><code class="docutils literal notranslate"><span class="pre">peak_cuda_memory()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.cuda_utils.release_memory"><code class="docutils literal notranslate"><span class="pre">release_memory()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.cuda_utils.AutoGPUMode"><code class="docutils literal notranslate"><span class="pre">AutoGPUMode</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.cuda_utils.GPUManager"><code class="docutils literal notranslate"><span class="pre">GPUManager</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.cuda_utils.GPUManager.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.cuda_utils.GPUManager.new_query"><code class="docutils literal notranslate"><span class="pre">new_query()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.cuda_utils.GPUManager.detect"><code class="docutils literal notranslate"><span class="pre">detect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.cuda_utils.GPUManager.auto_choice"><code class="docutils literal notranslate"><span class="pre">auto_choice()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.cuda_utils.device2gpu_id"><code class="docutils literal notranslate"><span class="pre">device2gpu_id()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.cuda_utils.num_gpus"><code class="docutils literal notranslate"><span class="pre">num_gpus()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.cuda_utils.is_cuda_available"><code class="docutils literal notranslate"><span class="pre">is_cuda_available()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.cuda_utils.patch_nvml_check_env"><code class="docutils literal notranslate"><span class="pre">patch_nvml_check_env()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.cuda_utils.NVMLDeviceCount"><code class="docutils literal notranslate"><span class="pre">NVMLDeviceCount</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#module-egrecho.utils.data_utils">egrecho.utils.data_utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.data_utils.split_sequence"><code class="docutils literal notranslate"><span class="pre">split_sequence()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.data_utils.Dillable"><code class="docutils literal notranslate"><span class="pre">Dillable</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.data_utils.iflatmap_unordered"><code class="docutils literal notranslate"><span class="pre">iflatmap_unordered()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.data_utils.buffer_shuffle"><code class="docutils literal notranslate"><span class="pre">buffer_shuffle()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.data_utils.ichunk_size"><code class="docutils literal notranslate"><span class="pre">ichunk_size()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.data_utils.ilen"><code class="docutils literal notranslate"><span class="pre">ilen()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.data_utils.zip_dict"><code class="docutils literal notranslate"><span class="pre">zip_dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.data_utils.ClassLabel"><code class="docutils literal notranslate"><span class="pre">ClassLabel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.data_utils.ClassLabel.str2int"><code class="docutils literal notranslate"><span class="pre">str2int()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.data_utils.ClassLabel.int2str"><code class="docutils literal notranslate"><span class="pre">int2str()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.data_utils.ClassLabel.from_dict"><code class="docutils literal notranslate"><span class="pre">from_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.data_utils.ClassLabel.to_file"><code class="docutils literal notranslate"><span class="pre">to_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.data_utils.ClassLabel.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.data_utils.SplitInfo"><code class="docutils literal notranslate"><span class="pre">SplitInfo</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.data_utils.SplitInfo.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.data_utils.SplitInfoDict"><code class="docutils literal notranslate"><span class="pre">SplitInfoDict</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.data_utils.SplitInfoDict.total_num_examples"><code class="docutils literal notranslate"><span class="pre">total_num_examples</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.data_utils.try_length"><code class="docutils literal notranslate"><span class="pre">try_length()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.data_utils.wavscp2dicts"><code class="docutils literal notranslate"><span class="pre">wavscp2dicts()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#module-egrecho.utils.dist">egrecho.utils.dist</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.dist.send_exit_ddp"><code class="docutils literal notranslate"><span class="pre">send_exit_ddp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.dist.get_free_port"><code class="docutils literal notranslate"><span class="pre">get_free_port()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.dist.is_port_in_use"><code class="docutils literal notranslate"><span class="pre">is_port_in_use()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.dist.DistInfo"><code class="docutils literal notranslate"><span class="pre">DistInfo</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.dist.DistInfo.detect"><code class="docutils literal notranslate"><span class="pre">detect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.dist.DistInfo.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.dist.WorkerInfo"><code class="docutils literal notranslate"><span class="pre">WorkerInfo</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.dist.WorkerInfo.detect"><code class="docutils literal notranslate"><span class="pre">detect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.dist.WorkerInfo.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.dist.EnvInfo"><code class="docutils literal notranslate"><span class="pre">EnvInfo</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.dist.EnvInfo.from_args"><code class="docutils literal notranslate"><span class="pre">from_args()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.dist.EnvInfo.num_shards"><code class="docutils literal notranslate"><span class="pre">num_shards</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.dist.EnvInfo.shard_rank"><code class="docutils literal notranslate"><span class="pre">shard_rank</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.dist.EnvInfo.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.dist.TorchMPLauncher"><code class="docutils literal notranslate"><span class="pre">TorchMPLauncher</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.dist.TorchMPLauncher.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.dist.TorchMPLauncher.launch"><code class="docutils literal notranslate"><span class="pre">launch()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#module-egrecho.utils.imports">egrecho.utils.imports</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.imports.is_package_available"><code class="docutils literal notranslate"><span class="pre">is_package_available()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.imports.is_module_available"><code class="docutils literal notranslate"><span class="pre">is_module_available()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.imports.compare_version"><code class="docutils literal notranslate"><span class="pre">compare_version()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.imports.lazy_import"><code class="docutils literal notranslate"><span class="pre">lazy_import()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.imports.LazyModule"><code class="docutils literal notranslate"><span class="pre">LazyModule</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.imports.LazyModule.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#module-egrecho.utils.logging">egrecho.utils.logging</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.logging.get_logger"><code class="docutils literal notranslate"><span class="pre">get_logger()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.logging.Logger"><code class="docutils literal notranslate"><span class="pre">Logger</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.logging.Logger.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.logging.Logger.info"><code class="docutils literal notranslate"><span class="pre">info()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.logging.Logger.info_once"><code class="docutils literal notranslate"><span class="pre">info_once()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.logging.Logger.warning"><code class="docutils literal notranslate"><span class="pre">warning()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.logging.Logger.warning_once"><code class="docutils literal notranslate"><span class="pre">warning_once()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.logging.Logger.debug"><code class="docutils literal notranslate"><span class="pre">debug()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.logging.Logger.error"><code class="docutils literal notranslate"><span class="pre">error()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.logging.Logger.error_once"><code class="docutils literal notranslate"><span class="pre">error_once()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#module-egrecho.utils.misc">egrecho.utils.misc</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.misc.ConfigurationException"><code class="docutils literal notranslate"><span class="pre">ConfigurationException</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.misc.NoneDataException"><code class="docutils literal notranslate"><span class="pre">NoneDataException</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.misc.parse_bytes"><code class="docutils literal notranslate"><span class="pre">parse_bytes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.misc.kill_name_proc"><code class="docutils literal notranslate"><span class="pre">kill_name_proc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.misc.valid_import_clspath"><code class="docutils literal notranslate"><span class="pre">valid_import_clspath()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.misc.class2str"><code class="docutils literal notranslate"><span class="pre">class2str()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.misc.get_import_path"><code class="docutils literal notranslate"><span class="pre">get_import_path()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.misc.locate_"><code class="docutils literal notranslate"><span class="pre">locate_()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#module-egrecho.utils.register">egrecho.utils.register</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.register.Register"><code class="docutils literal notranslate"><span class="pre">Register</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.register.Register.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.register.Register.register"><code class="docutils literal notranslate"><span class="pre">register()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.register.Register.get"><code class="docutils literal notranslate"><span class="pre">get()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.register.Register.keys"><code class="docutils literal notranslate"><span class="pre">keys()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.register.ExternalRegister"><code class="docutils literal notranslate"><span class="pre">ExternalRegister</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.register.ConcatRegister"><code class="docutils literal notranslate"><span class="pre">ConcatRegister</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.register.ConcatRegister.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.register.ConcatRegister.get"><code class="docutils literal notranslate"><span class="pre">get()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.register.ConcatRegister.keys"><code class="docutils literal notranslate"><span class="pre">keys()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.register.StrRegister"><code class="docutils literal notranslate"><span class="pre">StrRegister</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.register.StrRegister.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.register.StrRegister.register"><code class="docutils literal notranslate"><span class="pre">register()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.register.StrRegister.keys"><code class="docutils literal notranslate"><span class="pre">keys()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.register.ConcatStrRegister"><code class="docutils literal notranslate"><span class="pre">ConcatStrRegister</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.register.ConcatStrRegister.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.register.ConcatStrRegister.keys"><code class="docutils literal notranslate"><span class="pre">keys()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#module-egrecho.utils.torch_utils">egrecho.utils.torch_utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.torch_utils.RandomValue"><code class="docutils literal notranslate"><span class="pre">RandomValue</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.torch_utils.RandomValue.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.torch_utils.batch_pad_right"><code class="docutils literal notranslate"><span class="pre">batch_pad_right()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.torch_utils.pad_right_to"><code class="docutils literal notranslate"><span class="pre">pad_right_to()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.torch_utils.audio_collate_fn"><code class="docutils literal notranslate"><span class="pre">audio_collate_fn()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.torch_utils.to_numpy"><code class="docutils literal notranslate"><span class="pre">to_numpy()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#module-egrecho.utils.types">egrecho.utils.types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.types.ModelOutput"><code class="docutils literal notranslate"><span class="pre">ModelOutput</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.types.ModelOutput.setdefault"><code class="docutils literal notranslate"><span class="pre">setdefault()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.types.ModelOutput.pop"><code class="docutils literal notranslate"><span class="pre">pop()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.types.ModelOutput.update"><code class="docutils literal notranslate"><span class="pre">update()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.types.ModelOutput.to_tuple"><code class="docutils literal notranslate"><span class="pre">to_tuple()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.types.PipeOutput"><code class="docutils literal notranslate"><span class="pre">PipeOutput</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.types.SingletonMeta"><code class="docutils literal notranslate"><span class="pre">SingletonMeta</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.types.SingletonMeta.__call__"><code class="docutils literal notranslate"><span class="pre">__call__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.types.StrEnum"><code class="docutils literal notranslate"><span class="pre">StrEnum</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.types.StrEnum.from_str"><code class="docutils literal notranslate"><span class="pre">from_str()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html#egrecho.utils.types.StrEnum.try_from_str"><code class="docutils literal notranslate"><span class="pre">try_from_str()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/index.html#egrecho.utils.types.Split"><code class="docutils literal notranslate"><span class="pre">Split</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#egrecho-utils-dummy">egrecho.utils.dummy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/egrecho.utils.dummy.html">egrecho.utils.dummy.generate</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#egrecho-utils-io">egrecho.utils.io</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/egrecho.utils.io.html">egrecho.utils.io.files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.files.Url"><code class="docutils literal notranslate"><span class="pre">Url</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.files.is_remote_url"><code class="docutils literal notranslate"><span class="pre">is_remote_url()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.files.get_filename"><code class="docutils literal notranslate"><span class="pre">get_filename()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.files.DataFilesList"><code class="docutils literal notranslate"><span class="pre">DataFilesList</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.files.sanitize_patterns"><code class="docutils literal notranslate"><span class="pre">sanitize_patterns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.files.DataFilesDict"><code class="docutils literal notranslate"><span class="pre">DataFilesDict</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.files.resolve_patterns_locally_or_by_urls"><code class="docutils literal notranslate"><span class="pre">resolve_patterns_locally_or_by_urls()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.files.resolve_patterns"><code class="docutils literal notranslate"><span class="pre">resolve_patterns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.files.resolve_file"><code class="docutils literal notranslate"><span class="pre">resolve_file()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/egrecho.utils.io.html#module-egrecho.utils.io.kaldi">egrecho.utils.io.kaldi</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.kaldi.valid_kaldi_storage_name"><code class="docutils literal notranslate"><span class="pre">valid_kaldi_storage_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.kaldi.close_cached_kaldi_handles"><code class="docutils literal notranslate"><span class="pre">close_cached_kaldi_handles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.kaldi.lookup_matrix_reader_cache_or_open"><code class="docutils literal notranslate"><span class="pre">lookup_matrix_reader_cache_or_open()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.kaldi.lookup_vector_reader_cache_or_open"><code class="docutils literal notranslate"><span class="pre">lookup_vector_reader_cache_or_open()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.kaldi.KaldiVectorReader"><code class="docutils literal notranslate"><span class="pre">KaldiVectorReader</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.kaldi.KaldiVectorWriter"><code class="docutils literal notranslate"><span class="pre">KaldiVectorWriter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.kaldi.KaldiMatrixReader"><code class="docutils literal notranslate"><span class="pre">KaldiMatrixReader</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.kaldi.KaldiMatrixWriter"><code class="docutils literal notranslate"><span class="pre">KaldiMatrixWriter</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/egrecho.utils.io.html#module-egrecho.utils.io.reader">egrecho.utils.io.reader</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.reader.JsonlIterable"><code class="docutils literal notranslate"><span class="pre">JsonlIterable</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.reader.JsonIterable"><code class="docutils literal notranslate"><span class="pre">JsonIterable</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.reader.CsvIterable"><code class="docutils literal notranslate"><span class="pre">CsvIterable</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/egrecho.utils.io.html#module-egrecho.utils.io.resolve_ckpt">egrecho.utils.io.resolve_ckpt</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.resolve_ckpt.resolve_ckpt"><code class="docutils literal notranslate"><span class="pre">resolve_ckpt()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.resolve_ckpt.resolve_version_ckpt"><code class="docutils literal notranslate"><span class="pre">resolve_version_ckpt()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.resolve_ckpt.resolve_rel_ckpt"><code class="docutils literal notranslate"><span class="pre">resolve_rel_ckpt()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/egrecho.utils.io.html#module-egrecho.utils.io.utils">egrecho.utils.io.utils</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.utils.auto_open"><code class="docutils literal notranslate"><span class="pre">auto_open()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.utils.JsonMixin"><code class="docutils literal notranslate"><span class="pre">JsonMixin</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.utils.YamlMixin"><code class="docutils literal notranslate"><span class="pre">YamlMixin</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.utils.ConfigFileMixin"><code class="docutils literal notranslate"><span class="pre">ConfigFileMixin</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.utils.DictFileMixin"><code class="docutils literal notranslate"><span class="pre">DictFileMixin</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.utils.SerializationFn"><code class="docutils literal notranslate"><span class="pre">SerializationFn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.utils.load_jsonl_lazy"><code class="docutils literal notranslate"><span class="pre">load_jsonl_lazy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.utils.save_jsonl"><code class="docutils literal notranslate"><span class="pre">save_jsonl()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.utils.load_csv_lazy"><code class="docutils literal notranslate"><span class="pre">load_csv_lazy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.utils.repr_dict"><code class="docutils literal notranslate"><span class="pre">repr_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.utils.InvalidPathExtension"><code class="docutils literal notranslate"><span class="pre">InvalidPathExtension</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.utils.buf_count_newlines"><code class="docutils literal notranslate"><span class="pre">buf_count_newlines()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.utils.read_key_first_lists"><code class="docutils literal notranslate"><span class="pre">read_key_first_lists()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.utils.read_lists"><code class="docutils literal notranslate"><span class="pre">read_lists()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.utils.read_key_first_lists_lazy"><code class="docutils literal notranslate"><span class="pre">read_key_first_lists_lazy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.utils.read_lists_lazy"><code class="docutils literal notranslate"><span class="pre">read_lists_lazy()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/egrecho.utils.io.html#module-egrecho.utils.io.writer">egrecho.utils.io.writer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.writer.SequentialDewWriter"><code class="docutils literal notranslate"><span class="pre">SequentialDewWriter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.io.html#egrecho.utils.io.writer.ShardWriter"><code class="docutils literal notranslate"><span class="pre">ShardWriter</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#egrecho-utils-patch">egrecho.utils.patch</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/egrecho.utils.patch.html">egrecho.utils.patch.io_patch</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.patch.html#egrecho.utils.patch.io_patch.gzip_open_patch"><code class="docutils literal notranslate"><span class="pre">gzip_open_patch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.patch.html#egrecho.utils.patch.io_patch.AltGzipFile"><code class="docutils literal notranslate"><span class="pre">AltGzipFile</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.patch.html#egrecho.utils.patch.io_patch.FsspecLocalGlob"><code class="docutils literal notranslate"><span class="pre">FsspecLocalGlob</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.patch.html#egrecho.utils.patch.io_patch.make_path_posix"><code class="docutils literal notranslate"><span class="pre">make_path_posix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.patch.html#egrecho.utils.patch.io_patch.stringify_path"><code class="docutils literal notranslate"><span class="pre">stringify_path()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/egrecho.utils.patch.html#module-egrecho.utils.patch.torchdata_patch">egrecho.utils.patch.torchdata_patch</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.patch.html#egrecho.utils.patch.torchdata_patch.validate_input_col"><code class="docutils literal notranslate"><span class="pre">validate_input_col()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.patch.html#egrecho.utils.patch.torchdata_patch.StreamWrapper"><code class="docutils literal notranslate"><span class="pre">StreamWrapper</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.patch.html#egrecho.utils.patch.torchdata_patch.DataChunk"><code class="docutils literal notranslate"><span class="pre">DataChunk</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils/egrecho.utils.patch.html#egrecho-utils-patch-simple-parse-patch">egrecho.utils.patch.simple_parse_patch</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.patch.simple_parse_patch.html">egrecho.utils.patch.simple_parse_patch._utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.patch.simple_parse_patch.html#module-egrecho.utils.patch.simple_parse_patch.decoding">egrecho.utils.patch.simple_parse_patch.decoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.patch.simple_parse_patch.html#module-egrecho.utils.patch.simple_parse_patch.serializable">egrecho.utils.patch.simple_parse_patch.serializable</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.patch.simple_parse_patch.html#egrecho-utils-patch-simple-parse-patch-annotation-utils">egrecho.utils.patch.simple_parse_patch.annotation_utils</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html#egrecho-utils-seeder">egrecho.utils.seeder</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/egrecho.utils.seeder.html">egrecho.utils.seeder.seed</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.seeder.html#egrecho.utils.seeder.seed.SeedWorkers"><code class="docutils literal notranslate"><span class="pre">SeedWorkers</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/egrecho.utils.seeder.html#egrecho.utils.seeder.seed.isolate_rng"><code class="docutils literal notranslate"><span class="pre">isolate_rng()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html#egrecho-pipeline">egrecho.pipeline</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../pipeline/index.html">egrecho.pipeline.base</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../pipeline/index.html#egrecho.pipeline.base.DeviceMode"><code class="docutils literal notranslate"><span class="pre">DeviceMode</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../pipeline/index.html#egrecho.pipeline.base.PipeLine"><code class="docutils literal notranslate"><span class="pre">PipeLine</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../pipeline/index.html#egrecho.pipeline.base.PipeLine.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../pipeline/index.html#egrecho.pipeline.base.PipeLine.resolve_pretrained_model"><code class="docutils literal notranslate"><span class="pre">resolve_pretrained_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../pipeline/index.html#egrecho.pipeline.base.PipeLine.from_pretrained"><code class="docutils literal notranslate"><span class="pre">from_pretrained()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../pipeline/index.html#egrecho.pipeline.base.PipeLine.preprocess"><code class="docutils literal notranslate"><span class="pre">preprocess()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../pipeline/index.html#egrecho.pipeline.base.PipeLine.postprocess"><code class="docutils literal notranslate"><span class="pre">postprocess()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../pipeline/index.html#egrecho.pipeline.base.PipeLine.forward"><code class="docutils literal notranslate"><span class="pre">forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../pipeline/index.html#egrecho.pipeline.base.PipeLine.__call__"><code class="docutils literal notranslate"><span class="pre">__call__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../pipeline/index.html#egrecho.pipeline.base.PipeLine.to"><code class="docutils literal notranslate"><span class="pre">to()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../pipeline/index.html#egrecho.pipeline.base.PipelineDataset"><code class="docutils literal notranslate"><span class="pre">PipelineDataset</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../pipeline/index.html#egrecho.pipeline.base.PipelineDataset.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../pipeline/index.html#egrecho.pipeline.base.PipelineIterator"><code class="docutils literal notranslate"><span class="pre">PipelineIterator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../pipeline/index.html#egrecho.pipeline.base.PipelineIterator.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../pipeline/index.html#egrecho.pipeline.base.PipelineIterator.loader_batch_item"><code class="docutils literal notranslate"><span class="pre">loader_batch_item()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../pipeline/index.html#module-egrecho.pipeline.speaker_embedding">egrecho.pipeline.speaker_embedding</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../pipeline/index.html#egrecho.pipeline.speaker_embedding.SpeakerEmbedding"><code class="docutils literal notranslate"><span class="pre">SpeakerEmbedding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../pipeline/index.html#egrecho.pipeline.speaker_embedding.SpeakerEmbedding.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../pipeline/index.html#egrecho.pipeline.speaker_embedding.SpeakerEmbedding.from_pretrained"><code class="docutils literal notranslate"><span class="pre">from_pretrained()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../pipeline/index.html#egrecho.pipeline.speaker_embedding.SpeakerEmbedding.__call__"><code class="docutils literal notranslate"><span class="pre">__call__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../pipeline/index.html#egrecho.pipeline.speaker_embedding.SpeakerEmbedding.preprocess"><code class="docutils literal notranslate"><span class="pre">preprocess()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../pipeline/index.html#egrecho.pipeline.speaker_embedding.SpeakerEmbedding.postprocess"><code class="docutils literal notranslate"><span class="pre">postprocess()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">egrecho</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../api.html">egrecho.core</a></li>
      <li class="breadcrumb-item active">egrecho.core.module</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-egrecho.core.module">
<span id="egrecho-core-module"></span><h1>egrecho.core.module<a class="headerlink" href="#module-egrecho.core.module" title="Permalink to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="egrecho.core.module.TopVirtualModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.core.module.</span></span><span class="sig-name descname"><span class="pre">TopVirtualModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/core/module.py#L26-L412"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.core.module.TopVirtualModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">LightningModule</span></code></p>
<p>A lightning module is related to training, val, test.</p>
<p>In fit (train + validate) stage, you need to set <code class="docutils literal notranslate"><span class="pre">self.teacher</span></code>, where configures
step logics, dataloaders, criterion, etc.</p>
<dl class="py method">
<dt class="sig sig-object py" id="egrecho.core.module.TopVirtualModel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/core/module.py#L41-L44"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.core.module.TopVirtualModel.__init__" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.core.module.TopVirtualModel.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stage</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/core/module.py#L46-L86"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.core.module.TopVirtualModel.setup" title="Permalink to this definition"></a></dt>
<dd><p>Hook of <code class="xref py py-meth docutils literal notranslate"><span class="pre">lightning.pytorch.core.hooks.DataHooks.setup()</span></code>.</p>
<p>Called this at the beginning of fit (train + validate), validate, test, or predict. This is a good hook when
you need to build models dynamically or adjust something about them. This hook is called on every process
when using DDP.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="target" id="egrecho.core.module.TopVirtualModel.setup.params.stage"></span><strong>stage</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.module.TopVirtualModel.setup.params.stage">¶</a> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – either <code class="docutils literal notranslate"><span class="pre">'fit'</span></code>, <code class="docutils literal notranslate"><span class="pre">'validate'</span></code>, <code class="docutils literal notranslate"><span class="pre">'test'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'predict'</span></code></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">LitModel</span><span class="p">(</span><span class="n">TopVirtualModule</span><span class="p">):</span>
<span class="gp">... </span>   <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">l1</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stage</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">stage</span> <span class="o">==</span> <span class="s1">&#39;fit&#39;</span><span class="p">:</span>
<span class="gp">... </span>            <span class="bp">self</span><span class="o">.</span><span class="n">l1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">... </span>            <span class="bp">self</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">setup_model</span><span class="p">()</span>
<span class="gp">...</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">LitTeacher</span><span class="p">(</span><span class="n">Teacher</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">setup_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">classifier</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">training_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">pass</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">LitModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">teacher</span> <span class="o">=</span> <span class="n">LitTeacher</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">teacher</span> <span class="o">=</span> <span class="n">teacher</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="s2">&quot;fit&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">model</span><span class="o">.</span><span class="n">l1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">model</span><span class="o">.</span><span class="n">classifier</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.core.module.TopVirtualModel.training_step">
<span class="sig-name descname"><span class="pre">training_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/core/module.py#L102-L110"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.core.module.TopVirtualModel.training_step" title="Permalink to this definition"></a></dt>
<dd><p>Redirection to <a class="reference internal" href="#egrecho.core.module.TopVirtualModel.training_step" title="egrecho.core.module.TopVirtualModel.training_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">training_step()</span></code></a> in teacher.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.core.module.TopVirtualModel.validation_step">
<span class="sig-name descname"><span class="pre">validation_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/core/module.py#L112-L120"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.core.module.TopVirtualModel.validation_step" title="Permalink to this definition"></a></dt>
<dd><p>Redirection to <a class="reference internal" href="#egrecho.core.module.TopVirtualModel.training_step" title="egrecho.core.module.TopVirtualModel.training_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">training_step()</span></code></a> in teacher.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.core.module.TopVirtualModel.pipeline_out">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pipeline_out</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_out</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/core/module.py#L122-L127"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.core.module.TopVirtualModel.pipeline_out" title="Permalink to this definition"></a></dt>
<dd><p>Transform output (<code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code>) to dict for pipeline. write it for your specify model.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.core.module.TopVirtualModel.on_train_start">
<span class="sig-name descname"><span class="pre">on_train_start</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/core/module.py#L129-L139"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.core.module.TopVirtualModel.on_train_start" title="Permalink to this definition"></a></dt>
<dd><p>Called at the very beginning of train.</p>
<p>If on DDP it is called on every process</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.core.module.TopVirtualModel.on_train_end">
<span class="sig-name descname"><span class="pre">on_train_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/core/module.py#L141-L151"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.core.module.TopVirtualModel.on_train_end" title="Permalink to this definition"></a></dt>
<dd><p>Called at the very end of train.</p>
<p>If on DDP it is called on every process</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.core.module.TopVirtualModel.configure_optimizers">
<span class="sig-name descname"><span class="pre">configure_optimizers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/core/module.py#L153-L161"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.core.module.TopVirtualModel.configure_optimizers" title="Permalink to this definition"></a></dt>
<dd><p>Redirection to <a class="reference internal" href="#egrecho.core.module.TopVirtualModel.configure_optimizers" title="egrecho.core.module.TopVirtualModel.configure_optimizers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">configure_optimizers()</span></code></a> in teacher.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.core.module.TopVirtualModel.configure_teacher_callbacks">
<span class="sig-name descname"><span class="pre">configure_teacher_callbacks</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/core/module.py#L163-L204"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.core.module.TopVirtualModel.configure_teacher_callbacks" title="Permalink to this definition"></a></dt>
<dd><p>Configure teacher-specific callbacks.</p>
<p>Manually call this funtion to get callbacks and add them to your trainer.</p>
<dl>
<dt>Example::</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">LitTeacher</span><span class="p">(</span><span class="n">Teacher</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">setup_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">classifier</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">configure_teacher_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="p">[</span><span class="n">PrintCallback</span><span class="p">()]</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">training_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">pass</span>
<span class="gp">...</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">PrintCallback</span><span class="p">(</span><span class="n">Callback</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">on_train_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training is started!&quot;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">on_train_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training is done.&quot;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">LitModel</span><span class="p">(</span><span class="n">TopVirtualModule</span><span class="p">):</span>
<span class="gp">... </span>   <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">teacher</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">l1</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">teacher</span> <span class="o">=</span> <span class="n">teacher</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">setup_model</span><span class="p">()</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">teacher</span> <span class="o">=</span> <span class="n">LitTeacher</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">LitModel</span><span class="p">(</span><span class="n">teacher</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_callbacks</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">configure_teacher_callbacks</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">accelerator</span><span class="o">=</span><span class="s2">&quot;gpu&quot;</span><span class="p">,</span> <span class="n">devices</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="n">t_callbacks</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.core.module.TopVirtualModel.from_pretrained">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_pretrained</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_location</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hparams_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_mismatched_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/core/module.py#L206-L261"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.core.module.TopVirtualModel.from_pretrained" title="Permalink to this definition"></a></dt>
<dd><p>Load pretrained model from checkpoint.</p>
<p>This is raw now, to be implemented.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="egrecho.core.module.TopVirtualModel.from_pretrained.params.checkpoint_path"></span><strong>checkpoint_path</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.module.TopVirtualModel.from_pretrained.params.checkpoint_path">¶</a> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</span>) – Path to checkpoint. This can also be a URL, or file-like object.</p></li>
<li><p><span class="target" id="egrecho.core.module.TopVirtualModel.from_pretrained.params.map_location"></span><strong>map_location</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.module.TopVirtualModel.from_pretrained.params.map_location">¶</a> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]</span>) – <p>MAP_LOCATION_TYPE as in torch.load(). Defaults to ‘cpu’.</p>
<p>If you preferring to load a checkpoint saved a GPU model
to GPU, set it to None (not move to another GPU) or set a specified device.</p>
</p></li>
<li><p><span class="target" id="egrecho.core.module.TopVirtualModel.from_pretrained.params.hparams_file"></span><strong>hparams_file</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.module.TopVirtualModel.from_pretrained.params.hparams_file">¶</a> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]</span>) – <p>Path or str, optional
Path to a .yaml file with hierarchical structure
as in this example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">num_classes</span><span class="p">:</span> <span class="mi">5994</span>
<span class="n">config</span><span class="p">:</span>
    <span class="n">channels</span><span class="p">:</span> <span class="mi">1024</span>
</pre></div>
</div>
<p>You most likely won’t need this since Lightning will always save the
hyperparameters to the checkpoint. However, if your checkpoint weights
do not have the hyperparameters saved, use this method to pass in a .yaml
file with the hparams you would like to use. These will be converted
into a dict and passed into your Model for use.</p>
</p></li>
<li><p><span class="target" id="egrecho.core.module.TopVirtualModel.from_pretrained.params.ignore_mismatched_sizes"></span><strong>ignore_mismatched_sizes</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.module.TopVirtualModel.from_pretrained.params.ignore_mismatched_sizes">¶</a> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – bool
Whether or not to raise an error if some of the weights from the checkpoint do not have the same size
as the weights of the model (if for instance, you are instantiating a model with 10 labels from a
checkpoint with 3 labels). Defaults to False.</p></li>
<li><p><span class="target" id="egrecho.core.module.TopVirtualModel.from_pretrained.params.strict"></span><strong>strict</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.module.TopVirtualModel.from_pretrained.params.strict">¶</a> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – bool, optional
Whether to strictly enforce that the keys in checkpoint match
the keys returned by this module’s state dict. Defaults to True.</p></li>
<li><p><span class="target" id="egrecho.core.module.TopVirtualModel.from_pretrained.params.kwargs"></span><strong>kwargs</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.module.TopVirtualModel.from_pretrained.params.kwargs">¶</a> – optional
Any extra keyword args needed to init the model.
Can also be used to override saved hyperparameter values.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#egrecho.core.module.TopVirtualModel" title="egrecho.core.module.TopVirtualModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">TopVirtualModel</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.core.module.TopVirtualModel.auto">
<span class="sig-name descname"><span class="pre">auto</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/core/module.py#L263-L265"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.core.module.TopVirtualModel.auto" title="Permalink to this definition"></a></dt>
<dd><p>It is convenient for forward-computing when layer could be None or not</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.core.module.TopVirtualModel.export_onnx">
<span class="sig-name descname"><span class="pre">export_onnx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/../../../../../../opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/torch/autograd/grad_mode.py#L274-L322"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.core.module.TopVirtualModel.export_onnx" title="Permalink to this definition"></a></dt>
<dd><p>Exports the model in ONNX format in tracing mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="egrecho.core.module.TopVirtualModel.export_onnx.params.file_path"></span><strong>file_path</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.module.TopVirtualModel.export_onnx.params.file_path">¶</a> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>]</span>) – The path of the file the onnx model should be saved to.</p></li>
<li><p><span class="target" id="egrecho.core.module.TopVirtualModel.export_onnx.params.input_sample"></span><strong>input_sample</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.module.TopVirtualModel.export_onnx.params.input_sample">¶</a> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]</span>) – An input for tracing. Default: None (Use self.example_input_array)</p></li>
<li><p><span class="target" id="egrecho.core.module.TopVirtualModel.export_onnx.params.**kwargs"></span><strong>**kwargs</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.module.TopVirtualModel.export_onnx.params.**kwargs">¶</a> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></span>) – Will be passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.onnx.export()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This general method may not appropriate for every model, you can override it for your specify model.
If you want a Scripting onnx model, you should</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SimpleModel</span><span class="p">(</span><span class="n">TopVirtualModule</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">l1</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)))</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">SimpleModel</span><span class="p">()</span>
<span class="n">input_sample</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">export_onnx</span><span class="p">(</span><span class="s2">&quot;export.onnx&quot;</span><span class="p">,</span> <span class="n">input_sample</span><span class="p">,</span> <span class="n">export_params</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.core.module.TopVirtualModel.export_jit">
<span class="sig-name descname"><span class="pre">export_jit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'script'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/../../../../../../opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/torch/autograd/grad_mode.py#L324-L409"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.core.module.TopVirtualModel.export_jit" title="Permalink to this definition"></a></dt>
<dd><p>Exports the model to a TorchScript representation for inference or saving.</p>
<p>By default, compiles the entire model to a <code class="xref py py-class docutils literal notranslate"><span class="pre">ScriptModule</span></code>.
If you prefer to use tracing, provide the argument <code class="docutils literal notranslate"><span class="pre">method='trace'</span></code> and ensure that either the <code class="docutils literal notranslate"><span class="pre">input_sample</span></code> argument
is provided or the model has <code class="xref py py-attr docutils literal notranslate"><span class="pre">example_input_array</span></code> set for tracing. To customize which modules are scripted,
you can override this method. To return multiple modules, use a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="egrecho.core.module.TopVirtualModel.export_jit.params.file_path"></span><strong>file_path</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.module.TopVirtualModel.export_jit.params.file_path">¶</a> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em><em>]</em>) – Path to save the TorchScript representation. Default: None (no file saved).</p></li>
<li><p><span class="target" id="egrecho.core.module.TopVirtualModel.export_jit.params.method"></span><strong>method</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.module.TopVirtualModel.export_jit.params.method">¶</a> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Choose between ‘script’ (default) and ‘trace’ for TorchScript compilation methods.</p></li>
<li><p><span class="target" id="egrecho.core.module.TopVirtualModel.export_jit.params.input_sample"></span><strong>input_sample</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.module.TopVirtualModel.export_jit.params.input_sample">¶</a> (<em>Optional</em><em>[</em><em>Any</em><em>]</em>) – An input to be used for tracing when method is set to ‘trace’.</p></li>
<li><p><span class="target" id="egrecho.core.module.TopVirtualModel.export_jit.params.Default"></span><strong>Default</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.module.TopVirtualModel.export_jit.params.Default">¶</a> – None (uses <code class="xref py py-attr docutils literal notranslate"><span class="pre">example_input_array</span></code>) if available.</p></li>
<li><p><span class="target" id="egrecho.core.module.TopVirtualModel.export_jit.params.**kwargs"></span><strong>**kwargs</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.module.TopVirtualModel.export_jit.params.**kwargs">¶</a> (<em>Any</em>) – Additional arguments passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.jit.script()</span></code> or <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.jit.trace()</span></code>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>The exported script will be set to evaluation mode.</p></li>
<li><p>It is recommended to install the latest supported version of PyTorch for using this feature without limitations.</p></li>
</ul>
<p>Refer to the <code class="xref py py-mod docutils literal notranslate"><span class="pre">torch.jit</span></code> documentation for supported features.</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SimpleModel</span><span class="p">(</span><span class="n">TopVirtualModule</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">l1</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)))</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">SimpleModel</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">export_jit</span><span class="p">(</span><span class="s2">&quot;exported_model.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The converted TorchScript representation.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Union[ScriptModule, Dict[str, ScriptModule]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="egrecho.core.module.DataMoudle">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.core.module.</span></span><span class="sig-name descname"><span class="pre">DataMoudle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">builder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefetch_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_num_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pin_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fullsync</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">extra_dl_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/core/module.py#L424-L553"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.core.module.DataMoudle" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">LightningDataModule</span></code></p>
<p>A simple lightning datamoudle wrapper for dataloader.</p>
<p>The iterable dataset in <code class="xref py py-class docutils literal notranslate"><span class="pre">IterabelDatasetWrapper</span></code> auto sharding samples in
different ranks, we should load the dataset in hook: <a class="reference internal" href="#egrecho.core.module.DataMoudle.setup" title="egrecho.core.module.DataMoudle.setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setup()</span></code></a> as this hook is
called on every process when using DDP.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="egrecho.core.module.DataMoudle.params.builder"></span><strong>builder</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.module.DataMoudle.params.builder">¶</a> (<a class="reference internal" href="data_builder.html#egrecho.core.data_builder.DataBuilder" title="egrecho.core.data_builder.DataBuilder"><em>DataBuilder</em></a>) – The data builder instance of <a class="reference internal" href="data_builder.html#egrecho.core.data_builder.DataBuilder" title="egrecho.core.data_builder.DataBuilder"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataBuilder</span></code></a>
responsible for creating the dataset.</p></li>
<li><p><span class="target" id="egrecho.core.module.DataMoudle.params.batch_size"></span><strong>batch_size</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.module.DataMoudle.params.batch_size">¶</a> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – The batch size for DataLoader. Default is None for iterable dataset.</p></li>
<li><p><span class="target" id="egrecho.core.module.DataMoudle.params.num_workers"></span><strong>num_workers</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.module.DataMoudle.params.num_workers">¶</a> (<em>int</em>) – The number of workers for DataLoader. Default is 0.</p></li>
<li><p><span class="target" id="egrecho.core.module.DataMoudle.params.prefetch_factor"></span><strong>prefetch_factor</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.module.DataMoudle.params.prefetch_factor">¶</a> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – The prefetch factor for DataLoader. Default is None.</p></li>
<li><p><span class="target" id="egrecho.core.module.DataMoudle.params.val_num_workers"></span><strong>val_num_workers</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.module.DataMoudle.params.val_num_workers">¶</a> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – The number of workers for validation DataLoader. Defaults to 0. If
set None it will use the same number of workers as <cite>num_workers</cite>.</p></li>
<li><p><span class="target" id="egrecho.core.module.DataMoudle.params.pin_memory"></span><strong>pin_memory</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.module.DataMoudle.params.pin_memory">¶</a> (<em>bool</em>) – Whether to pin memory in DataLoader. Default is True.</p></li>
<li><p><span class="target" id="egrecho.core.module.DataMoudle.params.fullsync"></span><strong>fullsync</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.module.DataMoudle.params.fullsync">¶</a> (<em>bool</em>) – Whether to use <code class="xref py py-class docutils literal notranslate"><span class="pre">SyncDataLoader</span></code>. Default is True.</p></li>
<li><p><span class="target" id="egrecho.core.module.DataMoudle.params.**extra_dl_kwargs"></span><strong>**extra_dl_kwargs</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.module.DataMoudle.params.**extra_dl_kwargs">¶</a> – Additional keyword arguments to pass to DataLoader.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="egrecho.core.module.DataMoudle.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">builder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefetch_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_num_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pin_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fullsync</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">extra_dl_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/core/module.py#L453-L476"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.core.module.DataMoudle.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="py attribute">
<dt class="sig sig-object py" id="egrecho.core.module.DataMoudle.prepare_data_per_node">
<span class="sig-name descname"><span class="pre">prepare_data_per_node</span></span><a class="headerlink" href="#egrecho.core.module.DataMoudle.prepare_data_per_node" title="Permalink to this definition"></a></dt>
<dd><p>If True, each LOCAL_RANK=0 will call prepare data.
Otherwise only NODE_RANK=0, LOCAL_RANK=0 will prepare data.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="egrecho.core.module.DataMoudle.allow_zero_length_dataloader_with_multiple_devices">
<span class="sig-name descname"><span class="pre">allow_zero_length_dataloader_with_multiple_devices</span></span><a class="headerlink" href="#egrecho.core.module.DataMoudle.allow_zero_length_dataloader_with_multiple_devices" title="Permalink to this definition"></a></dt>
<dd><p>If True, dataloader with zero length within local rank is allowed.
Default value is False.</p>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.core.module.DataMoudle.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stage</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/core/module.py#L478-L479"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.core.module.DataMoudle.setup" title="Permalink to this definition"></a></dt>
<dd><p>Called at the beginning of fit (train + validate), validate, test, or predict. This is a good hook when
you need to build models dynamically or adjust something about them. This hook is called on every process
when using DDP.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="target" id="egrecho.core.module.DataMoudle.setup.params.stage"></span><strong>stage</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.module.DataMoudle.setup.params.stage">¶</a> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – either <code class="docutils literal notranslate"><span class="pre">'fit'</span></code>, <code class="docutils literal notranslate"><span class="pre">'validate'</span></code>, <code class="docutils literal notranslate"><span class="pre">'test'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'predict'</span></code></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">LitModel</span><span class="p">(</span><span class="o">...</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l1</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">prepare_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">()</span>
        <span class="n">tokenize</span><span class="p">()</span>

        <span class="c1"># don&#39;t do this</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">something</span> <span class="o">=</span> <span class="k">else</span>

    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stage</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">num_classes</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.core.module.DataMoudle.setup_data">
<span class="sig-name descname"><span class="pre">setup_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/core/module.py#L481-L491"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.core.module.DataMoudle.setup_data" title="Permalink to this definition"></a></dt>
<dd><p>Builds datasets and assigns dataloader func to lightning datamodule.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="egrecho.core.module.DataMoudle.train_dataset">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">train_dataset</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dataset</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#egrecho.core.module.DataMoudle.train_dataset" title="Permalink to this definition"></a></dt>
<dd><p>This property returns the train dataset.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="egrecho.core.module.DataMoudle.val_dataset">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">val_dataset</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dataset</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#egrecho.core.module.DataMoudle.val_dataset" title="Permalink to this definition"></a></dt>
<dd><p>This property returns the validation dataset.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="egrecho.core.module.DataMoudle.test_dataset">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">test_dataset</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dataset</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#egrecho.core.module.DataMoudle.test_dataset" title="Permalink to this definition"></a></dt>
<dd><p>This property returns the test dataset.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-egrecho.core.model_base"></span><dl class="py class">
<dt class="sig sig-object py" id="egrecho.core.model_base.ModuleConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.core.model_base.</span></span><span class="sig-name descname"><span class="pre">ModuleConfig</span></span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/core/model_base.py#L21-L25"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.core.model_base.ModuleConfig" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="config.html#egrecho.core.config.DataclassConfig" title="egrecho.core.config.DataclassConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataclassConfig</span></code></a></p>
<p>Base class for model configuration.</p>
<dl class="py method">
<dt class="sig sig-object py" id="egrecho.core.model_base.ModuleConfig.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#egrecho.core.model_base.ModuleConfig.__init__" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="egrecho.core.model_base.ModelBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.core.model_base.</span></span><span class="sig-name descname"><span class="pre">ModelBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/core/model_base.py#L66-L261"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.core.model_base.ModelBase" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleUtilMixin</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A virtual backbone that provides common utilities.</p>
<p>Its implementation is used to aggregate components of submodules to a model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="egrecho.core.model_base.ModelBase.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/core/model_base.py#L78-L80"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.core.model_base.ModelBase.__init__" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.core.model_base.ModelBase.post_init">
<span class="sig-name descname"><span class="pre">post_init</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/core/model_base.py#L82-L86"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.core.model_base.ModelBase.post_init" title="Permalink to this definition"></a></dt>
<dd><p>Gives a chance to perform additional operations at the end of the model’s initialization process.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="egrecho.core.model_base.ModelBase.dummy_inputs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dummy_inputs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#egrecho.core.model_base.ModelBase.dummy_inputs" title="Permalink to this definition"></a></dt>
<dd><p>Dummy inputs to do a forward pass in the network.</p>
<p>The return type is interpreted as follows:</p>
<ul class="simple">
<li><p>Single tensor: It is assumed the model takes a single argument, i.e.,
<code class="docutils literal notranslate"><span class="pre">model.forward(model.dummy_inputs)</span></code>.</p></li>
<li><p>Tuple: The inputs is interpreted as a sequence of positional arguments, i.e.,
<code class="docutils literal notranslate"><span class="pre">model.forward(*model.dummy_inputs)</span></code>.</p></li>
<li><p>Dict: The input array represents named keyword arguments, i.e.,
<code class="docutils literal notranslate"><span class="pre">model.forward(**model.dummy_inputs)</span></code>.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.core.model_base.ModelBase.export_onnx">
<span class="sig-name descname"><span class="pre">export_onnx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/../../../../../../opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/torch/autograd/grad_mode.py#L126-L174"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.core.model_base.ModelBase.export_onnx" title="Permalink to this definition"></a></dt>
<dd><p>Exports the model in ONNX format in tracing mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="egrecho.core.model_base.ModelBase.export_onnx.params.file_path"></span><strong>file_path</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.model_base.ModelBase.export_onnx.params.file_path">¶</a> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>]</span>) – The path of the file the onnx model should be saved to.</p></li>
<li><p><span class="target" id="egrecho.core.model_base.ModelBase.export_onnx.params.input_sample"></span><strong>input_sample</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.model_base.ModelBase.export_onnx.params.input_sample">¶</a> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]</span>) – An input for tracing. Default: None (Use <a class="reference internal" href="#egrecho.core.model_base.ModelBase.dummy_inputs" title="egrecho.core.model_base.ModelBase.dummy_inputs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dummy_inputs</span></code></a>)</p></li>
<li><p><span class="target" id="egrecho.core.model_base.ModelBase.export_onnx.params.**kwargs"></span><strong>**kwargs</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.model_base.ModelBase.export_onnx.params.**kwargs">¶</a> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></span>) – Will be passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.onnx.export()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This general method may not appropriate for every model, you can override it for your specify model.</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SimpleModel</span><span class="p">(</span><span class="n">TopVirtualModule</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">l1</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)))</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">SimpleModel</span><span class="p">()</span>
<span class="n">input_sample</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">export_onnx</span><span class="p">(</span><span class="s2">&quot;export.onnx&quot;</span><span class="p">,</span> <span class="n">input_sample</span><span class="p">,</span> <span class="n">export_params</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.core.model_base.ModelBase.export_jit">
<span class="sig-name descname"><span class="pre">export_jit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'script'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/../../../../../../opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/torch/autograd/grad_mode.py#L176-L261"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.core.model_base.ModelBase.export_jit" title="Permalink to this definition"></a></dt>
<dd><p>Exports the model to a TorchScript representation for inference or saving.</p>
<p>By default, compiles the entire model to a <code class="xref py py-class docutils literal notranslate"><span class="pre">ScriptModule</span></code>.
If you prefer to use tracing, provide the argument <code class="docutils literal notranslate"><span class="pre">method='trace'</span></code> and
ensure that either the <code class="docutils literal notranslate"><span class="pre">input_sample</span></code> argument is provided or the model
has <a class="reference internal" href="#egrecho.core.model_base.ModelBase.dummy_inputs" title="egrecho.core.model_base.ModelBase.dummy_inputs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dummy_inputs</span></code></a> set for tracing. To customize which modules are scripted,
you can override this method. To return multiple modules, use a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="egrecho.core.model_base.ModelBase.export_jit.params.file_path"></span><strong>file_path</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.model_base.ModelBase.export_jit.params.file_path">¶</a> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em><em>]</em>) – Path to save the TorchScript representation.
Default: None (no file saved).</p></li>
<li><p><span class="target" id="egrecho.core.model_base.ModelBase.export_jit.params.method"></span><strong>method</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.model_base.ModelBase.export_jit.params.method">¶</a> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Choose between ‘script’ (default) and ‘trace’ for TorchScript compilation methods.</p></li>
<li><p><span class="target" id="egrecho.core.model_base.ModelBase.export_jit.params.input_sample"></span><strong>input_sample</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.model_base.ModelBase.export_jit.params.input_sample">¶</a> (<em>Optional</em><em>[</em><em>Any</em><em>]</em>) – An input to be used for tracing when method is set to ‘trace’.
Default: None (uses <a class="reference internal" href="#egrecho.core.model_base.ModelBase.dummy_inputs" title="egrecho.core.model_base.ModelBase.dummy_inputs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dummy_inputs</span></code></a>) if available.</p></li>
<li><p><span class="target" id="egrecho.core.model_base.ModelBase.export_jit.params.**kwargs"></span><strong>**kwargs</strong><a class="paramlink headerlink reference internal" href="#egrecho.core.model_base.ModelBase.export_jit.params.**kwargs">¶</a> (<em>Any</em>) – Additional arguments passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.jit.script()</span></code> or <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.jit.trace()</span></code>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>The exported script will be set to evaluation mode.</p></li>
<li><p>It is recommended to install the latest supported version of PyTorch for using this feature without limitations.</p></li>
</ul>
<p>Refer to the pytorch <code class="xref py py-mod docutils literal notranslate"><span class="pre">torch.jit</span></code> documentation for supported features.</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SimpleModel</span><span class="p">(</span><span class="n">TopVirtualModule</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">l1</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)))</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">SimpleModel</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">export_jit</span><span class="p">(</span><span class="s2">&quot;exported_model.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The converted TorchScript representation.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Union[ScriptModule, Dict[str, ScriptModule]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="loads.html" class="btn btn-neutral float-left" title="egrecho.core.loads" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="optimization.html" class="btn btn-neutral float-right" title="egrecho.core.optimization" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Dexin Liao.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>