<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="egrecho.utils.dummy.generate" href="egrecho.utils.dummy.html" /><link rel="prev" title="egrecho.core.tokenizer" href="../core/tokenizer.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2024.08.06 -->
        <title>egrecho.utils.apply - Documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d75fae25" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/fontawesome.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/solid.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/brands.min.css" />
    
    


<style>
  body {
    --color-code-background: #f0f0f0;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>

<div class="announcement">
  <aside class="announcement-content">
     <em>Feedback welcomed ðŸŽ‰ at <a href='http://xxx'>dummy url</a></em> 
  </aside>
</div>

<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Content</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial_installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial_dynamic_project.html">Dynamic Project</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../api.html">egrecho.core</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of egrecho.core</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../core/config.html">egrecho.core.config</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core/data_builder.html">egrecho.core.data_builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core/feature_extractor.html">egrecho.core.feature_extractor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core/loads.html">egrecho.core.loads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core/module.html">egrecho.core.module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core/optimization.html">egrecho.core.optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core/parser.html">egrecho.core.parser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core/teacher.html">egrecho.core.teacher</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core/tokenizer.html">egrecho.core.tokenizer</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../api.html#egrecho-utils">egrecho.utils</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of egrecho.utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">egrecho.utils.apply</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-egrecho.utils.common">egrecho.utils.common</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-egrecho.utils.constants">egrecho.utils.constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-egrecho.utils.cuda_utils">egrecho.utils.cuda_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-egrecho.utils.data_utils">egrecho.utils.data_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-egrecho.utils.dist">egrecho.utils.dist</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-egrecho.utils.imports">egrecho.utils.imports</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-egrecho.utils.logging">egrecho.utils.logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-egrecho.utils.mask">egrecho.utils.mask</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-egrecho.utils.misc">egrecho.utils.misc</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-egrecho.utils.register">egrecho.utils.register</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-egrecho.utils.torch_utils">egrecho.utils.torch_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-egrecho.utils.types">egrecho.utils.types</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="#egrecho-utils-dummy">egrecho.utils.dummy</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of egrecho.utils.dummy</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="egrecho.utils.dummy.html">egrecho.utils.dummy.generate</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="#egrecho-utils-io">egrecho.utils.io</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of egrecho.utils.io</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="egrecho.utils.io.html">egrecho.utils.io.files</a></li>
<li class="toctree-l3"><a class="reference internal" href="egrecho.utils.io.html#module-egrecho.utils.io.kaldi">egrecho.utils.io.kaldi</a></li>
<li class="toctree-l3"><a class="reference internal" href="egrecho.utils.io.html#module-egrecho.utils.io.reader">egrecho.utils.io.reader</a></li>
<li class="toctree-l3"><a class="reference internal" href="egrecho.utils.io.html#module-egrecho.utils.io.resolve_ckpt">egrecho.utils.io.resolve_ckpt</a></li>
<li class="toctree-l3"><a class="reference internal" href="egrecho.utils.io.html#module-egrecho.utils.io.utils">egrecho.utils.io.utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="egrecho.utils.io.html#module-egrecho.utils.io.writer">egrecho.utils.io.writer</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="#egrecho-utils-patch">egrecho.utils.patch</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of egrecho.utils.patch</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="egrecho.utils.patch.html">egrecho.utils.patch.io_patch</a></li>
<li class="toctree-l3"><a class="reference internal" href="egrecho.utils.patch.html#module-egrecho.utils.patch.torchdata_patch">egrecho.utils.patch.torchdata_patch</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="egrecho.utils.patch.html#egrecho-utils-patch-simple-parse-patch">egrecho.utils.patch.simple_parse_patch</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of egrecho.utils.patch.simple_parse_patch</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="egrecho.utils.patch.simple_parse_patch.html">egrecho.utils.patch.simple_parse_patch._utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="egrecho.utils.patch.simple_parse_patch.html#module-egrecho.utils.patch.simple_parse_patch.decoding">egrecho.utils.patch.simple_parse_patch.decoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="egrecho.utils.patch.simple_parse_patch.html#module-egrecho.utils.patch.simple_parse_patch.serializable">egrecho.utils.patch.simple_parse_patch.serializable</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="egrecho.utils.patch.simple_parse_patch.html#egrecho-utils-patch-simple-parse-patch-annotation-utils">egrecho.utils.patch.simple_parse_patch.annotation_utils</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of egrecho.utils.patch.simple_parse_patch.annotation_utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="egrecho.utils.patch.simple_parse_patch.annotation_utils.html">egrecho.utils.patch.simple_parse_patch.annotation_utils</a></li>
<li class="toctree-l5"><a class="reference internal" href="egrecho.utils.patch.simple_parse_patch.annotation_utils.html#module-egrecho.utils.patch.simple_parse_patch.annotation_utils.get_field_annotations">egrecho.utils.patch.simple_parse_patch.annotation_utils.get_field_annotations</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="#egrecho-utils-seeder">egrecho.utils.seeder</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of egrecho.utils.seeder</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="egrecho.utils.seeder.html">egrecho.utils.seeder.seed</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="#egrecho-utils-text">egrecho.utils.text</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of egrecho.utils.text</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="egrecho.utils.text.html">egrecho.utils.text.cleaners</a></li>
<li class="toctree-l3"><a class="reference internal" href="egrecho.utils.text.html#module-egrecho.utils.text.number_cn">egrecho.utils.text.number_cn</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api.html#egrecho-pipeline">egrecho.pipeline</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of egrecho.pipeline</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../pipeline/index.html">egrecho.pipeline.base</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pipeline/index.html#module-egrecho.pipeline.speaker_embedding">egrecho.pipeline.speaker_embedding</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/wangers/subtools2/blob/master/docs/source/api/utils/index.md?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/wangers/subtools2/edit/master/docs/source/api/utils/index.md" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="module-egrecho.utils.apply">
<span id="egrecho-utils-apply"></span><h1>egrecho.utils.apply<a class="headerlink" href="#module-egrecho.utils.apply" title="Permalink to this heading">#</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.apply.apply_to_collection">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.apply.</span></span><span class="sig-name descname"><span class="pre">apply_to_collection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrong_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_none</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/apply.py#L14-L138"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.apply.apply_to_collection" title="Permalink to this definition">#</a></dt>
<dd><p>Recursively applies a function to all elements of a certain dtype.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></span>) -- the collection to apply the function to</p></li>
<li><p><strong>dtype</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">type</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">type</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]]</span>) -- the given function will be applied to all elements of this dtype</p></li>
<li><p><strong>function</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></span>) -- the function to apply</p></li>
<li><p><strong>*args</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></span>) -- positional arguments (will be forwarded to calls of <code class="docutils literal notranslate"><span class="pre">function</span></code>)</p></li>
<li><p><strong>wrong_dtype</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">type</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">type</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]</span>) -- the given function wonâ€™t be applied if this type is specified and the given collections
is of the <code class="docutils literal notranslate"><span class="pre">wrong_dtype</span></code> even if it is of type <code class="docutils literal notranslate"><span class="pre">dtype</span></code></p></li>
<li><p><strong>include_none</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) -- Whether to include an element if the output of <code class="docutils literal notranslate"><span class="pre">function</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>allow_frozen</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) -- Whether not to error upon encountering a frozen dataclass instance.</p></li>
<li><p><strong>**kwargs</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></span>) -- keyword arguments (will be forwarded to calls of <code class="docutils literal notranslate"><span class="pre">function</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The resulting collection</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-egrecho.utils.common">
<span id="egrecho-utils-common"></span><h1>egrecho.utils.common<a class="headerlink" href="#module-egrecho.utils.common" title="Permalink to this heading">#</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.common.alt_none">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.common.</span></span><span class="sig-name descname"><span class="pre">alt_none</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alt_item</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/common.py#L37-L41"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.common.alt_none" title="Permalink to this definition">#</a></dt>
<dd><p>Replace None with  <code class="docutils literal notranslate"><span class="pre">alt_item</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.common.is_in_range">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.common.</span></span><span class="sig-name descname"><span class="pre">is_in_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/common.py#L44-L67"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.common.is_in_range" title="Permalink to this definition">#</a></dt>
<dd><p>Value in range judging.</p>
<p>Range is close interval (e.g., [1, 2]), If the boundary is None, skip that condition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>val</strong> -- value to be judged.</p></li>
<li><p><strong>max_val</strong> (<em>Optional</em><em>[</em><em>Any</em><em>]</em><em>, </em><em>optional</em>) -- Defaults to None.</p></li>
<li><p><strong>min_val</strong> (<em>Optional</em><em>[</em><em>Any</em><em>]</em><em>, </em><em>optional</em>) -- Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.common.ObjectDict">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.common.</span></span><span class="sig-name descname"><span class="pre">ObjectDict</span></span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/common.py#L70-L108"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.common.ObjectDict" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></p>
<p>Makes a dictionary behave like an object, with attribute-style access.</p>
<p>Here are some examples of how it can be used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">o</span> <span class="o">=</span> <span class="n">ObjectDict</span><span class="p">(</span><span class="n">my_dict</span><span class="p">)</span>
<span class="c1"># or like this:</span>
<span class="n">o</span> <span class="o">=</span> <span class="n">ObjectDict</span><span class="p">(</span><span class="n">samples</span><span class="o">=</span><span class="n">samples</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">sample_rate</span><span class="p">)</span>
<span class="c1"># Attribute-style access</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">samples</span>
<span class="c1"># Dict-style access</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">o</span><span class="p">[</span><span class="s2">&quot;samples&quot;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.common.DataclassSerialMixin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.common.</span></span><span class="sig-name descname"><span class="pre">DataclassSerialMixin</span></span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/common.py#L123-L214"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.common.DataclassSerialMixin" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>From/to dict mixin of dataclass.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@dataclass</span>
<span class="gp">... </span><span class="k">class</span><span class="w"> </span><span class="nc">Config</span><span class="p">(</span><span class="n">DataclassSerialMixin</span><span class="p">):</span>
<span class="gp">... </span>  <span class="n">a</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span>
<span class="gp">... </span>  <span class="n">b</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;456&quot;</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">(</span><span class="n">filt_type</span><span class="o">=</span><span class="s1">&#39;orig&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">config</span>
<span class="go">Config(a=123, b=&#39;456&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">config</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="go">{&#39;a&#39;: 123, &#39;b&#39;: &#39;456&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">config_</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">from_dict</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="mi">456</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">config_</span>
<span class="go">Config(a=123, b=&#39;456&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">config</span> <span class="o">==</span> <span class="n">config_</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.common.DataclassSerialMixin.to_dict">
<span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dict_factory=&lt;class</span> <span class="pre">'dict'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_type=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_field_only=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dc_types=False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/common.py#L175-L192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.common.DataclassSerialMixin.to_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Serializes this dataclass to a dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.common.DataclassSerialMixin.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/common.py#L194-L214"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.common.DataclassSerialMixin.from_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Parses an instance of <code class="docutils literal notranslate"><span class="pre">cls</span></code> from the given dict.</p>
<p>NOTE: If the <code class="docutils literal notranslate"><span class="pre">decode_into_subclasses</span></code> class attribute is set to True (or
if <code class="docutils literal notranslate"><span class="pre">decode_into_subclasses=True</span></code> was passed in the class definition),
then if there are keys in the dict that arenâ€™t fields of the dataclass,
this will decode the dict into an instance the first subclass of <cite>cls</cite>
which has all required field names present in the dictionary.</p>
<ul class="simple">
<li><dl class="simple">
<dt>Passing <code class="docutils literal notranslate"><span class="pre">drop_extra_fields=None</span></code> (default) will use the class attribute</dt><dd><p>described above.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Passing <code class="docutils literal notranslate"><span class="pre">drop_extra_fields=True</span></code> will decode the dict into an instance</dt><dd><p>of <code class="docutils literal notranslate"><span class="pre">cls</span></code> and drop the extra keys in the dict.
Passing <code class="docutils literal notranslate"><span class="pre">drop_extra_fields=False</span></code> forces the above-mentioned behaviour.</p>
</dd>
</dl>
</li>
</ul>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.common.GenericSerialMixin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.common.</span></span><span class="sig-name descname"><span class="pre">GenericSerialMixin</span></span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/common.py#L217-L304"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.common.GenericSerialMixin" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Serialization mixin of common class with config attribute.</p>
<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.common.GenericSerialMixin.to_dict">
<span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/common.py#L222-L238"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.common.GenericSerialMixin.to_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Returns objectâ€™s configuration to config dictionary</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.common.GenericSerialMixin.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/common.py#L240-L304"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.common.GenericSerialMixin.from_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Instantiates object using DictConfig-based configuration</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.common.SaveLoadMixin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.common.</span></span><span class="sig-name descname"><span class="pre">SaveLoadMixin</span></span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/common.py#L307-L321"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.common.SaveLoadMixin" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Save_to/load_from repo.</p>
<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.common.SaveLoadMixin.fetch_from">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fetch_from</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirpath</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/common.py#L318-L321"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.common.SaveLoadMixin.fetch_from" title="Permalink to this definition">#</a></dt>
<dd><p>Fetch from a repo.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.common.fields_init_var">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.common.</span></span><span class="sig-name descname"><span class="pre">fields_init_var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">class_or_instance</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/common.py#L324-L342"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.common.fields_init_var" title="Permalink to this definition">#</a></dt>
<dd><p>Return a tuple describing the <code class="docutils literal notranslate"><span class="pre">InitVar</span></code> fields of this dataclass.</p>
<p>Modified from:
<a class="reference external" href="https://docs.python.org/3/library/dataclasses.html#dataclasses.fields">https://docs.python.org/3/library/dataclasses.html#dataclasses.fields</a></p>
<p>Accepts a dataclass or an instance of one. Tuple elements are of
type Field.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.common.batched">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.common.</span></span><span class="sig-name descname"><span class="pre">batched</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/common.py#L355-L362"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.common.batched" title="Permalink to this definition">#</a></dt>
<dd><p>Batch data into tuples of length n. The last batch may be shorter.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.common.camelcase_to_snakecase">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.common.</span></span><span class="sig-name descname"><span class="pre">camelcase_to_snakecase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/common.py#L372-L376"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.common.camelcase_to_snakecase" title="Permalink to this definition">#</a></dt>
<dd><p>Convert camel-case string to snake-case.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.common.snakecase_to_camelcase">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.common.</span></span><span class="sig-name descname"><span class="pre">snakecase_to_camelcase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/common.py#L379-L383"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.common.snakecase_to_camelcase" title="Permalink to this definition">#</a></dt>
<dd><p>Convert snake-case string to camel-case string.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.common.get_diff_dict">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.common.</span></span><span class="sig-name descname"><span class="pre">get_diff_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">curr_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/common.py#L386-L409"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.common.get_diff_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Compare two dictionaries and return a new dictionary containing the differing key-value pairs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>curr_dict</strong> (<em>Dict</em>) -- The current dictionary to compare.</p></li>
<li><p><strong>src_dict</strong> (<em>Dict</em>) -- The source dictionary to compare against.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the key-value pairs that differ between <code class="docutils literal notranslate"><span class="pre">src_dict</span></code> and <code class="docutils literal notranslate"><span class="pre">curr_dict</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">src_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">curr_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="mi">35</span><span class="p">,</span> <span class="s2">&quot;city&quot;</span><span class="p">:</span> <span class="s2">&quot;New York&quot;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diff_dict</span> <span class="o">=</span> <span class="n">get_diff_dict</span><span class="p">(</span><span class="n">curr_dict</span><span class="p">,</span> <span class="n">src_dict</span><span class="p">)</span>
<span class="go">{&#39;age&#39;: 35, &#39;city&#39;: &#39;New York&#39;}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.common.del_default_dict">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.common.</span></span><span class="sig-name descname"><span class="pre">del_default_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">defaults</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recurse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/common.py#L412-L442"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.common.del_default_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Removes key-value pairs from a dictionary that match default values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Dict</em>) -- The dictionary to remove default values from.</p></li>
<li><p><strong>defaults</strong> (<em>Dict</em>) -- The dictionary containing default values to compare against.</p></li>
<li><p><strong>recurse</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) -- recursively processes. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary with default values removed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;city&quot;</span><span class="p">:</span> <span class="s2">&quot;New York&quot;</span><span class="p">,</span> <span class="s2">&quot;zip&quot;</span><span class="p">:</span> <span class="mi">10001</span><span class="p">}}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">defaults</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;city&quot;</span><span class="p">:</span> <span class="s2">&quot;Unknown&quot;</span><span class="p">,</span> <span class="s2">&quot;zip&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cleaned_data</span> <span class="o">=</span> <span class="n">del_default_dict</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">defaults</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cleaned_data</span>
<span class="go">{&#39;address&#39;: {&#39;city&#39;: &#39;New York&#39;, &#39;zip&#39;: 10001}}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function modifies the <cite>data</cite> dictionary in place and also returns it. If
<code class="docutils literal notranslate"><span class="pre">recurse=True</span></code> it recursively processes nested dictionaries.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.common.dict_union">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.common.</span></span><span class="sig-name descname"><span class="pre">dict_union</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">*dicts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recurse=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_keys=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dict_factory=&lt;class</span> <span class="pre">'dict'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/common.py#L445-L507"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.common.dict_union" title="Permalink to this definition">#</a></dt>
<dd><p>Combine multiple dictionaries into the first one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*dicts</strong> (<em>dict</em>) -- One or more dictionaries to combine.</p></li>
<li><p><strong>recurse</strong> (<em>bool</em><em>, </em><em>optional</em>) -- If True, also recursively combine nested dictionaries.</p></li>
<li><p><strong>sort_keys</strong> (<em>bool</em><em>, </em><em>optional</em>) -- If True, sort the keys alphabetically in the resulting dictionary.</p></li>
<li><p><strong>dict_factory</strong> (<em>callable</em><em>, </em><em>optional</em>) -- A callable that creates the output dictionary (default is <cite>dict</cite>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new dictionary containing the union of all input dictionaries.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dict_union</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">dict_factory</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">)</span>
<span class="go">OrderedDict([(&#39;a&#39;, 1), (&#39;b&#39;, 2), (&#39;c&#39;, 5), (&#39;d&#39;, 6), (&#39;e&#39;, 7)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dict_union</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">dict_factory</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">)</span>
<span class="go">OrderedDict([(&#39;a&#39;, 2), (&#39;b&#39;, OrderedDict([(&#39;c&#39;, 3), (&#39;d&#39;, 3), (&#39;e&#39;, 6)]))])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.common.list2tuple">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.common.</span></span><span class="sig-name descname"><span class="pre">list2tuple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/common.py#L510-L548"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.common.list2tuple" title="Permalink to this definition">#</a></dt>
<dd><p>Transfer the list in input parameter to hashable tuple, it is useful for <code class="docutils literal notranslate"><span class="pre">lru_cache</span></code>.</p>
<p>NOTE: Donâ€™t support nest structure.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">get_input</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@list2tuple</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">get_input_wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arg_input</span> <span class="o">=</span> <span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;foo&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs_input</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;bar&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;go&quot;</span><span class="p">,</span> <span class="s2">&quot;leave&quot;</span><span class="p">,</span> <span class="s2">&quot;break&quot;</span><span class="p">],</span> <span class="s1">&#39;action1&#39;</span><span class="p">:[</span><span class="s1">&#39;buy&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;sell&#39;</span><span class="p">,</span> <span class="s1">&#39;argue&#39;</span><span class="p">]]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_input</span><span class="p">(</span><span class="o">*</span><span class="n">arg_input</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_input</span><span class="p">)</span>
<span class="go">(([1, 2, 3], &#39;foo&#39;),</span>
<span class="go">{&#39;bar&#39;: True,</span>
<span class="go">&#39;action&#39;: [&#39;go&#39;, &#39;leave&#39;, &#39;break&#39;],</span>
<span class="go">&#39;action1&#39;: [&#39;buy&#39;, [&#39;sell&#39;, &#39;argue&#39;]]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_input_wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">arg_input</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_input</span><span class="p">)</span>
<span class="go">(((1, 2, 3), &#39;foo&#39;),</span>
<span class="go">{&#39;bar&#39;: True,</span>
<span class="go">&#39;action&#39;: (&#39;go&#39;, &#39;leave&#39;, &#39;break&#39;),</span>
<span class="go">&#39;action1&#39;: (&#39;buy&#39;, [&#39;sell&#39;, &#39;argue&#39;])})</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.common.omegaconf_handler">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.common.</span></span><span class="sig-name descname"><span class="pre">omegaconf_handler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omegaconf_resolve</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/common.py#L563-L581"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.common.omegaconf_handler" title="Permalink to this definition">#</a></dt>
<dd><p>If omegaconf is available, creates DictConfig and resolves it when omegaconf_resolve=True.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]</span>) -- lodaded kwargs dict.</p></li>
<li><p><strong>omegaconf_resolve</strong> -- If False, returns DictConfig else returns the dict resolved from DictConfig.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-egrecho.utils.constants">
<span id="egrecho-utils-constants"></span><h1>egrecho.utils.constants<a class="headerlink" href="#module-egrecho.utils.constants" title="Permalink to this heading">#</a></h1>
</section>
<section id="module-egrecho.utils.cuda_utils">
<span id="egrecho-utils-cuda-utils"></span><h1>egrecho.utils.cuda_utils<a class="headerlink" href="#module-egrecho.utils.cuda_utils" title="Permalink to this heading">#</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.cuda_utils.avoid_float16_autocast_context">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.cuda_utils.</span></span><span class="sig-name descname"><span class="pre">avoid_float16_autocast_context</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/cuda_utils.py#L26-L41"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.cuda_utils.avoid_float16_autocast_context" title="Permalink to this definition">#</a></dt>
<dd><p>If the current autocast context is float16, cast it to bfloat16
if available (unless weâ€™re in jit) or float32</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.cuda_utils.maybe_set_cuda_expandable_segments">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.cuda_utils.</span></span><span class="sig-name descname"><span class="pre">maybe_set_cuda_expandable_segments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">enabled</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/cuda_utils.py#L45-L70"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.cuda_utils.maybe_set_cuda_expandable_segments" title="Permalink to this definition">#</a></dt>
<dd><p>Configures PyTorch memory allocator to expand existing allocated segments
instead of re-allocating them when tensor shape grows.
This can help speed up the training when sequence length and/or batch size change often,
and makes GPU more robust towards OOM.</p>
<p>See here for more details:
<a class="reference external" href="https://pytorch.org/docs/stable/notes/cuda.html#optimizing-memory-usage-with-pytorch-cuda-alloc-conf">https://pytorch.org/docs/stable/notes/cuda.html#optimizing-memory-usage-with-pytorch-cuda-alloc-conf</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.cuda_utils.set_to_cuda">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.cuda_utils.</span></span><span class="sig-name descname"><span class="pre">set_to_cuda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modules</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/cuda_utils.py#L73-L88"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.cuda_utils.set_to_cuda" title="Permalink to this definition">#</a></dt>
<dd><p>Send modules to gpu.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>modules</strong> -- nn.module or a list of module</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.cuda_utils.get_current_device">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.cuda_utils.</span></span><span class="sig-name descname"><span class="pre">get_current_device</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/cuda_utils.py#L91-L99"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.cuda_utils.get_current_device" title="Permalink to this definition">#</a></dt>
<dd><p>Returns currently selected device (gpu/cpu).
If cuda available, return gpu, otherwise return cpu.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.cuda_utils.to_device">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.cuda_utils.</span></span><span class="sig-name descname"><span class="pre">to_device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device_object</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/cuda_utils.py#L132-L178"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.cuda_utils.to_device" title="Permalink to this definition">#</a></dt>
<dd><p>Move a tensor or collection of tensors to a specified device by inferring the device from another object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Any</em>) -- A tensor, collection of tensors, or anything with a <code class="docutils literal notranslate"><span class="pre">.to(...)</span></code> method.</p></li>
<li><p><strong>device_object</strong> (<em>Union</em><em>[</em><em>torch.device</em><em>, </em><em>str</em><em>, </em><em>int</em><em>, </em><em>torch.Tensor</em><em>, </em><em>torch.nn.Module</em><em>]</em><em>, </em><em>optional</em>) -- <p>The target device. Can be one of the following:</p>
<blockquote>
<div><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">torch.device</span></code>, <code class="docutils literal notranslate"><span class="pre">str</span></code>, <code class="docutils literal notranslate"><span class="pre">int</span></code>, The target device.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>: Infer the device from a module.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">torch.Tensor</span></code>: Infer the device from a tensor.
(default: the current defualt cuda device.)</p></li>
</ul>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The same collection with all contained tensors residing on the target device.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.cuda_utils.parse_gpus">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.cuda_utils.</span></span><span class="sig-name descname"><span class="pre">parse_gpus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gpus</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/cuda_utils.py#L181-L208"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.cuda_utils.parse_gpus" title="Permalink to this definition">#</a></dt>
<dd><p>Parse gpus option.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>gpus</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]</span>) -- <p>GPUs used for training on this machine.</p>
<p>-1: all;
N: [0,N);
â€œ1,2â€: comma-seperated; â€œ0â€ means invalid while â€œ0,â€ specify 1 gpu with id:1.</p>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.cuda_utils.parse_gpus_opt">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.cuda_utils.</span></span><span class="sig-name descname"><span class="pre">parse_gpus_opt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gpus</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/cuda_utils.py#L211-L246"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.cuda_utils.parse_gpus_opt" title="Permalink to this definition">#</a></dt>
<dd><p>Similar to <cite>parse_gpus</cite> but combines auto choose a single GPU.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>gpus</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em><em>]</em>) -- <p>What GPUs should be used:</p>
<ul class="simple">
<li><p>case 0: comma-separated list, e.g., â€œ1,â€ or â€œ0,1â€ means specified id(s).</p></li>
<li><p>case 1: a single int (str) negative number (-1) means all visible devices <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">N-1]</span></code>.</p></li>
<li><p>case 2: â€˜â€™ or None or 0 returns None means no GPU.</p></li>
<li><p>case 3: a single int (str) number equals 1 means auto choose a spare GPU.</p></li>
<li><p>case 4: a single int (str) number n greater than 1 returns <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">n-1]</span></code>.</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of GPU IDs or None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[List[int]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.cuda_utils.parse_gpu_id">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.cuda_utils.</span></span><span class="sig-name descname"><span class="pre">parse_gpu_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gpu_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/cuda_utils.py#L249-L287"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.cuda_utils.parse_gpu_id" title="Permalink to this definition">#</a></dt>
<dd><p>Parse single gpu id option.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>gpu_id</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em><em>]</em>) -- <p>select which GPU:</p>
<ul class="simple">
<li><p>case 0: â€œautoâ€, auto select spare gpu.</p></li>
<li><p>case 1: a single int (str) negative number (-1) means cpu.</p></li>
<li><p>case 2: a single int (str) positive number means specified id.</p></li>
<li><p>case 3: â€˜â€™ or None returns None, which means defualt behaviour in same case, e.g., torch.load(â€¦)</p></li>
<li><p>case 4: other strings, e.g., â€œcuda:1â€</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.cuda_utils.synchronize">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.cuda_utils.</span></span><span class="sig-name descname"><span class="pre">synchronize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/cuda_utils.py#L342-L347"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.cuda_utils.synchronize" title="Permalink to this definition">#</a></dt>
<dd><p>Similar to cuda.synchronize().
Waits for all kernels in all streams on a CUDA device to complete.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.cuda_utils.peak_cuda_memory">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.cuda_utils.</span></span><span class="sig-name descname"><span class="pre">peak_cuda_memory</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/cuda_utils.py#L350-L364"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.cuda_utils.peak_cuda_memory" title="Permalink to this definition">#</a></dt>
<dd><p>Return the peak gpu memory statistics.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the allocated CUDA memory
max_cached (float): the cached CUDA memory</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>max_alloc (float)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.cuda_utils.release_memory">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.cuda_utils.</span></span><span class="sig-name descname"><span class="pre">release_memory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">objects</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/cuda_utils.py#L368-L402"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.cuda_utils.release_memory" title="Permalink to this definition">#</a></dt>
<dd><p>Triggers garbage collection and Releases cuda cache memory.</p>
<p>This function sets the inputs to <cite>None</cite>, triggers garbage collection to release
CPU memory references, and attempts to clear GPU memory cache.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*objects</strong> -- Variable number of objects to release.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of <cite>None</cite> values, with the same length as the input objects.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[None]</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">release_memory</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="go">```</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.cuda_utils.AutoGPUMode">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.cuda_utils.</span></span><span class="sig-name descname"><span class="pre">AutoGPUMode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/cuda_utils.py#L405-L408"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.cuda_utils.AutoGPUMode" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<p>An enumeration.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.cuda_utils.GPUManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.cuda_utils.</span></span><span class="sig-name descname"><span class="pre">GPUManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">addtional_qargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">AutoGPUMode.MAX_MEM</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/cuda_utils.py#L411-L600"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.cuda_utils.GPUManager" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class enables the automated selection of the most available GPU or another based on specified mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>addtional_qargs</strong> (<em>Optional</em>) -- Additional arguments passed to <code class="docutils literal notranslate"><span class="pre">nvidia-smi</span></code>.</p></li>
<li><p><strong>mode</strong> (<a class="reference internal" href="#egrecho.utils.cuda_utils.AutoGPUMode" title="egrecho.utils.cuda_utils.AutoGPUMode"><em>AutoGPUMode</em></a>) -- mode for GPU selection.
Defaults to MAX_MEM (max-free) memory.</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span><span class="o">,</span><span class="nn">torch</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CUDA_VISIBLE_DEVICES&quot;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;1,2&quot;</span>
<span class="n">gm</span> <span class="o">=</span> <span class="n">GPUManager</span><span class="p">()</span>
<span class="n">torch_device</span> <span class="o">=</span> <span class="n">gm</span><span class="o">.</span><span class="n">auto_choice</span><span class="p">()</span>

<span class="ow">or</span>

<span class="n">torch_device</span> <span class="o">=</span> <span class="n">GPUManager</span><span class="o">.</span><span class="n">detect</span><span class="p">()</span>


<span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">a</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">torch_device</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.cuda_utils.GPUManager.new_query">
<span class="sig-name descname"><span class="pre">new_query</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/cuda_utils.py#L488-L509"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.cuda_utils.GPUManager.new_query" title="Permalink to this definition">#</a></dt>
<dd><p>Running the <code class="docutils literal notranslate"><span class="pre">nvidia-smi</span></code> command and organizing the results as a list of dictionaries
containing information searched from <cite>nvidia-smi</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.cuda_utils.GPUManager.detect">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">detect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">AutoGPUMode.MAX_MEM</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/cuda_utils.py#L516-L520"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.cuda_utils.GPUManager.detect" title="Permalink to this definition">#</a></dt>
<dd><p>A classmethod calls :meth`auto_choice` method to select a GPU and returns dveice id.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.cuda_utils.GPUManager.auto_choice">
<span class="sig-name descname"><span class="pre">auto_choice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/cuda_utils.py#L522-L565"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.cuda_utils.GPUManager.auto_choice" title="Permalink to this definition">#</a></dt>
<dd><p>Auto choice a GPU ID based on specified mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mode</strong> (<em>str</em>) -- The mode for selecting the GPU.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>device id.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.cuda_utils.device2gpu_id">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.cuda_utils.</span></span><span class="sig-name descname"><span class="pre">device2gpu_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device_id</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/cuda_utils.py#L603-L608"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.cuda_utils.device2gpu_id" title="Permalink to this definition">#</a></dt>
<dd><p>Given the device index and get the unmasked real GPU ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.cuda_utils.num_gpus">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.cuda_utils.</span></span><span class="sig-name descname"><span class="pre">num_gpus</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#egrecho.utils.cuda_utils.num_gpus" title="Permalink to this definition">#</a></dt>
<dd><p>Get visible gpu number.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.cuda_utils.is_cuda_available">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.cuda_utils.</span></span><span class="sig-name descname"><span class="pre">is_cuda_available</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/cuda_utils.py#L622-L631"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.cuda_utils.is_cuda_available" title="Permalink to this definition">#</a></dt>
<dd><p>check cuda and leave cuda uninitialized.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.cuda_utils.patch_nvml_check_env">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.cuda_utils.</span></span><span class="sig-name descname"><span class="pre">patch_nvml_check_env</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/../../../../../../opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/contextlib.py#L634-L644"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.cuda_utils.patch_nvml_check_env" title="Permalink to this definition">#</a></dt>
<dd><p>A context manager that patch <code class="docutils literal notranslate"><span class="pre">PYTORCH_NVML_BASED_CUDA_CHECK=1</span></code>, and restore finally.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.cuda_utils.NVMLDeviceCount">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.cuda_utils.</span></span><span class="sig-name descname"><span class="pre">NVMLDeviceCount</span></span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/cuda_utils.py#L647-L820"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.cuda_utils.NVMLDeviceCount" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A tool for nvml-based cuda check for torch &lt; 2.0 which wonâ€™t trigger the drivers and leave cuda
uninitialized.</p>
<dl class="simple">
<dt>Coppied from pytorch, see:</dt><dd><p><a class="reference external" href="https://github.com/pytorch/pytorch/pull/84879">https://github.com/pytorch/pytorch/pull/84879</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-egrecho.utils.data_utils">
<span id="egrecho-utils-data-utils"></span><h1>egrecho.utils.data_utils<a class="headerlink" href="#module-egrecho.utils.data_utils" title="Permalink to this heading">#</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.data_utils.split_sequence">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.data_utils.</span></span><span class="sig-name descname"><span class="pre">split_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'batch'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/data_utils.py#L36-L100"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.data_utils.split_sequence" title="Permalink to this definition">#</a></dt>
<dd><p>Split a sequence into <code class="docutils literal notranslate"><span class="pre">num_splits</span></code> equal parts. The element order can be randomized.
Raises a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> if <code class="docutils literal notranslate"><span class="pre">split_num</span></code> is larger than <code class="docutils literal notranslate"><span class="pre">len(seq)</span></code>.
Support mode of â€˜shardâ€™ or â€˜batchâ€™. If â€˜batchâ€™, the splits lists as original sequence
else shard the original sequence, e.g., for spliting <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1</span> <span class="pre">,</span> <span class="pre">2,</span> <span class="pre">3]</span></code> to 2 parts,
shard mode result: <code class="docutils literal notranslate"><span class="pre">[[0,</span> <span class="pre">2],</span> <span class="pre">[1,</span> <span class="pre">3]]</span></code> while batch mode reult: <code class="docutils literal notranslate"><span class="pre">[[0,</span> <span class="pre">1],</span> <span class="pre">[2,</span> <span class="pre">3]]</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seq</strong> (<em>Sequence</em>) -- Input iterable.</p></li>
<li><p><strong>num_splits</strong> (<em>int</em>) -- Split num.</p></li>
<li><p><strong>mode</strong> (<em>str</em>) -- (â€˜shardâ€™, â€˜batchâ€™)</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em>) -- If true, shuffle input sequence before split it.</p></li>
<li><p><strong>drop_last</strong> (<em>bool</em>) -- If true, drop last items when <code class="docutils literal notranslate"><span class="pre">len(seq)</span></code> is not divisible by <code class="docutils literal notranslate"><span class="pre">num_splits</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of smaller squences.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.data_utils.Dillable">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.data_utils.</span></span><span class="sig-name descname"><span class="pre">Dillable</span></span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/data_utils.py#L103-L120"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.data_utils.Dillable" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Mix-in that will leverage <code class="docutils literal notranslate"><span class="pre">dill</span></code> instead of <code class="docutils literal notranslate"><span class="pre">pickle</span></code>
when pickling an object.</p>
<p>It is useful when the user canâ€™t avoid <code class="docutils literal notranslate"><span class="pre">pickle</span></code> (e.g. in multiprocessing),
but needs to use unpicklable objects such as lambdas.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.data_utils.iflatmap_unordered">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.data_utils.</span></span><span class="sig-name descname"><span class="pre">iflatmap_unordered</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_iter</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/data_utils.py#L129-L164"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.data_utils.iflatmap_unordered" title="Permalink to this definition">#</a></dt>
<dd><p>Parrallized mapping operation.</p>
<p>Note: Data are in kwargs_iter, and flats reults of all jobs to a queue.
This operation donâ€™t keep the original order in async way.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nj</strong> (<em>int</em>) -- num of jobs.</p></li>
<li><p><strong>fn</strong> (<em>Callable</em>) -- a function can yied results from given args.</p></li>
<li><p><strong>kwargs_iter</strong> (<em>Iterable</em><em>[</em><em>dict</em><em>]</em>) -- kwargs map to <code class="docutils literal notranslate"><span class="pre">fn</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.data_utils.buffer_shuffle">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.data_utils.</span></span><span class="sig-name descname"><span class="pre">buffer_shuffle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/data_utils.py#L176-L212"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.data_utils.buffer_shuffle" title="Permalink to this definition">#</a></dt>
<dd><p>Buffer shuffle the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Iterable</em>) -- data source.</p></li>
<li><p><strong>buffer_size</strong> (<em>int</em>) -- defaults to 10000.</p></li>
<li><p><strong>rng</strong> (<em>np.random.Generator</em>) -- fix random.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Generator yields data item.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.data_utils.ichunk_size">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.data_utils.</span></span><span class="sig-name descname"><span class="pre">ichunk_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">total_len</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">even</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/data_utils.py#L215-L281"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.data_utils.ichunk_size" title="Permalink to this definition">#</a></dt>
<dd><p>Infer an enven split chunksize generator before applying split operation if needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>total_len</strong> (<em>int</em>) -- The lengths to be divided.</p></li>
<li><p><strong>chunk_size</strong> (<em>int</em>) -- </p></li>
<li><p><strong>split_num</strong> (<em>int</em>) -- Number of splits, can be provided to infer chunksizes.</p></li>
<li><p><strong>even</strong> (<em>bool</em>) -- If True, the max differ between chunksize is 1.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A generator yields sizes of total length.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">ichunk_size</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">chunk_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">even</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>  <span class="c1"># chunk_size=10, total_len=15, adapt (10, 5) -&gt; (8, 7).</span>
<span class="go">[8, 7]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">ichunk_size</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">split_num</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">even</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>  <span class="c1"># split_num=4, total_len=10, adapt chunksize (3, 3, 3, 1) -&gt; (3, 3, 2, 2).</span>
<span class="go">[3, 3, 2, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.data_utils.ilen">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.data_utils.</span></span><span class="sig-name descname"><span class="pre">ilen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/data_utils.py#L284-L296"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.data_utils.ilen" title="Permalink to this definition">#</a></dt>
<dd><p>Return the number of items in iterable inputs.</p>
<p>This consumes the iterable data, so handle with care.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ilen</span><span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000000</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">333334</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.data_utils.zip_dict">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.data_utils.</span></span><span class="sig-name descname"><span class="pre">zip_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">dicts</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/data_utils.py#L307-L313"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.data_utils.zip_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Iterate over items of dictionaries grouped by their keys.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.data_utils.ClassLabel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.data_utils.</span></span><span class="sig-name descname"><span class="pre">ClassLabel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/data_utils.py#L317-L591"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.data_utils.ClassLabel" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">DictFileMixin</span></code></p>
<p>The instance of this class stores the string names of labels,
can be used for mapping str2label or label2str.</p>
<p>Modified from <a class="reference external" href="https://github.com/huggingface/datasets/blob/main/src/datasets/features/features.py#ClassLabel">HuggingFace Datasets</a>.</p>
<dl class="simple">
<dt>There are 3 ways to define a <code class="docutils literal notranslate"><span class="pre">ClassLabel</span></code>, which correspond to the 3 arguments:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">num_classes</span></code>: Create 0 to (num_classes-1) labels.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">names</span></code>: List of label strings.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">names_file</span></code>: File (Text) containing the list of labels.</p></li>
</ul>
</dd>
</dl>
<p>Under the hood the labels are stored as integers.
You can use negative integers to represent unknown/missing labels.</p>
<p>Serialize/deserialize of yaml files will be in a more readable way (<code class="docutils literal notranslate"><span class="pre">from_yaml</span></code>, â€˜<cite>to_yaml`</cite>):</p>
<blockquote>
<div><p>names:                  -&gt;                names:</p>
<ul class="simple">
<li><p>negative              -&gt;                  â€˜0â€™: negative</p></li>
<li><p>positive              -&gt;                  â€˜1â€™: positive</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_classes</strong> (<cite>int</cite>, <em>optional</em>) -- Number of classes. All labels must be <code class="docutils literal notranslate"><span class="pre">&lt;</span> <span class="pre">num_classes</span></code>.</p></li>
<li><p><strong>names</strong> (<cite>list</cite> of <cite>str</cite>, <em>optional</em>) -- String names for the integer classes.
The order in which the names are provided is kept.</p></li>
<li><p><strong>names_file</strong> (<cite>str</cite>, <em>optional</em>) -- Path to a file with names for the integer classes, one per line.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">label</span> <span class="o">=</span> <span class="n">ClassLabel</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;speaker1&#39;</span><span class="p">,</span> <span class="s1">&#39;speaker2&#39;</span><span class="p">,</span> <span class="s1">&#39;speaker3&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label</span>
<span class="go">ClassLabel(num_classes=3, names=[&#39;speaker1&#39;, &#39;speaker2&#39;, &#39;speaker3&#39;], id=None)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label</span><span class="o">.</span><span class="n">encode_label</span><span class="p">(</span><span class="s1">&#39;speaker1&#39;</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label</span><span class="o">.</span><span class="n">encode_label</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label</span><span class="o">.</span><span class="n">encode_label</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.data_utils.ClassLabel.str2int">
<span class="sig-name descname"><span class="pre">str2int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/data_utils.py#L424-L445"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.data_utils.ClassLabel.str2int" title="Permalink to this definition">#</a></dt>
<dd><p>Conversion class name <code class="docutils literal notranslate"><span class="pre">string</span></code> =&gt; <code class="docutils literal notranslate"><span class="pre">integer</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code>]</span></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">label</span> <span class="o">=</span> <span class="n">ClassLabel</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;speaker1&#39;</span><span class="p">,</span> <span class="s1">&#39;speaker2&#39;</span><span class="p">,</span> <span class="s1">&#39;speaker3&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label</span><span class="o">.</span><span class="n">str2int</span><span class="p">(</span><span class="s1">&#39;speaker1&#39;</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.data_utils.ClassLabel.int2str">
<span class="sig-name descname"><span class="pre">int2str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/data_utils.py#L468-L495"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.data_utils.ClassLabel.int2str" title="Permalink to this definition">#</a></dt>
<dd><p>Conversion <code class="docutils literal notranslate"><span class="pre">integer</span></code> =&gt; class name <code class="docutils literal notranslate"><span class="pre">string</span></code>.</p>
<p>Regarding unknown/missing labels: passing negative integers raises <code class="docutils literal notranslate"><span class="pre">ValueError</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code>]</span></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">label</span> <span class="o">=</span> <span class="n">ClassLabel</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;speaker1&#39;</span><span class="p">,</span> <span class="s1">&#39;speaker2&#39;</span><span class="p">,</span> <span class="s1">&#39;speaker3&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label</span><span class="o">.</span><span class="n">int2str</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">&#39;speaker1&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.data_utils.ClassLabel.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/data_utils.py#L512-L536"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.data_utils.ClassLabel.from_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Deserialize from dict.</p>
<p>transform dict to list:</p>
<blockquote>
<div><p>names:                -&gt;                  names:</p>
<p>â€˜0â€™: negative         -&gt;                  - negative</p>
<p>â€˜1â€™: positive         -&gt;                  - positive</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.data_utils.ClassLabel.to_file">
<span class="sig-name descname"><span class="pre">to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_vocab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/data_utils.py#L538-L569"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.data_utils.ClassLabel.to_file" title="Permalink to this definition">#</a></dt>
<dd><p>Serialize to a dict file.</p>
<p>names:                  -&gt;                names:</p>
<ul class="simple">
<li><p>negative              -&gt;                  â€˜0â€™: negative</p></li>
<li><p>positive              -&gt;                  â€˜1â€™: positive</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</span>) -- file path</p></li>
<li><p><strong>save_vocab</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) -- also saves a clean vocab json, i.e., str2int:</p></li>
<li><p><strong>{'negative'</strong> -- 0, â€˜positiveâ€™:1}</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.data_utils.VSORT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.data_utils.</span></span><span class="sig-name descname"><span class="pre">VSORT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/data_utils.py#L597-L599"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.data_utils.VSORT" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#egrecho.utils.types.StrEnum" title="egrecho.utils.types.StrEnum"><code class="xref py py-class docutils literal notranslate"><span class="pre">StrEnum</span></code></a></p>
<p>An enumeration.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.data_utils.count_vocab_from_iterator">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.data_utils.</span></span><span class="sig-name descname"><span class="pre">count_vocab_from_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterator</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/data_utils.py#L779-L804"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.data_utils.count_vocab_from_iterator" title="Permalink to this definition">#</a></dt>
<dd><p>Build a Vocab counter from an iterator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>iterator</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></span>) -- Iterator used to count vocab. Must yield list or iterator of tokens.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">VocabCounter</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Obj of <code class="xref py py-class docutils literal notranslate"><span class="pre">VocabCounter</span></code>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#generating vocab from text file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">egrecho.utils.data_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">build_vocab_from_iterator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">yield_tokens</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">with</span> <span class="n">io</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="k">yield</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vocab_counter</span> <span class="o">=</span> <span class="n">count_vocab_from_iterator</span><span class="p">(</span><span class="n">yield_tokens</span><span class="p">(</span><span class="n">file_path</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.data_utils.build_vocab_from_iterator">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.data_utils.</span></span><span class="sig-name descname"><span class="pre">build_vocab_from_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savedir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vocab'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specials</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">special_first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_tokens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/data_utils.py#L807-L852"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.data_utils.build_vocab_from_iterator" title="Permalink to this definition">#</a></dt>
<dd><p>Build a Vocab from an iterator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iterator</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></span>) -- Iterator used to build Vocab. Must yield list or iterator of tokens.</p></li>
<li><p><strong>savedir</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]</span>) -- Path directory to save the vocab file. if None, will skip save.</p></li>
<li><p><strong>fname</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) -- filename</p></li>
<li><p><strong>specials</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]</span>) -- Special symbols to add. The order of supplied tokens will be preserved.</p></li>
<li><p><strong>special_first</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) -- Indicates whether to insert symbols at the beginning or at the end.</p></li>
<li><p><strong>min_freq</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) -- If provided , defines the minimum frequency needed to include a token in the vocabulary.</p></li>
<li><p><strong>max_tokens</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) -- If provided &gt; 0 creates the vocab from the <cite>max_tokens - len(specials)</cite> most frequent tokens.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#egrecho.utils.data_utils.ClassLabel" title="egrecho.utils.data_utils.ClassLabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClassLabel</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Obj of <a class="reference internal" href="#egrecho.utils.data_utils.ClassLabel" title="egrecho.utils.data_utils.ClassLabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClassLabel</span></code></a>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#generating vocab from text file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">egrecho.utils.data_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">build_vocab_from_iterator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">yield_tokens</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">with</span> <span class="n">io</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="k">yield</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vocab</span> <span class="o">=</span> <span class="n">build_vocab_from_iterator</span><span class="p">(</span><span class="n">yield_tokens</span><span class="p">(</span><span class="n">file_path</span><span class="p">),</span> <span class="n">specials</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;&lt;unk&gt;&quot;</span><span class="p">])</span>
<span class="gp">... </span><span class="c1"># or save files</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vocab</span> <span class="o">=</span> <span class="n">build_vocab_from_iterator</span><span class="p">(</span><span class="n">yield_tokens</span><span class="p">(</span><span class="n">file_path</span><span class="p">),</span> <span class="n">savedir</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">specials</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;&lt;unk&gt;&quot;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.data_utils.SplitInfo">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.data_utils.</span></span><span class="sig-name descname"><span class="pre">SplitInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patterns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_examples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/data_utils.py#L856-L868"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.data_utils.SplitInfo" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A container of split dataset info.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.data_utils.try_length">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.data_utils.</span></span><span class="sig-name descname"><span class="pre">try_length</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/data_utils.py#L917-L924"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.data_utils.try_length" title="Permalink to this definition">#</a></dt>
<dd><p>Try to get the length of an object, fallback to return <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.data_utils.wavscp2dicts">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.data_utils.</span></span><span class="sig-name descname"><span class="pre">wavscp2dicts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wav_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_utt_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'id'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_path_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'audio_path'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/data_utils.py#L927-L942"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.data_utils.wavscp2dicts" title="Permalink to this definition">#</a></dt>
<dd><p>Read wav.scp to a list of dict</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]</span></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-egrecho.utils.dist">
<span id="egrecho-utils-dist"></span><h1>egrecho.utils.dist<a class="headerlink" href="#module-egrecho.utils.dist" title="Permalink to this heading">#</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.dist.send_exit_ddp">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.dist.</span></span><span class="sig-name descname"><span class="pre">send_exit_ddp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stop_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/dist.py#L35-L46"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.dist.send_exit_ddp" title="Permalink to this definition">#</a></dt>
<dd><p>reduce stop signal across ddp progresses, controled by main rank.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.dist.get_free_port">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.dist.</span></span><span class="sig-name descname"><span class="pre">get_free_port</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/dist.py#L57-L69"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.dist.get_free_port" title="Permalink to this definition">#</a></dt>
<dd><p>Select a free port for localhost.</p>
<p>Useful in single-node training when we donâ€™t want to connect to a real main node but have to set the
<code class="docutils literal notranslate"><span class="pre">MASTER_PORT</span></code> environment variable.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.dist.is_port_in_use">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.dist.</span></span><span class="sig-name descname"><span class="pre">is_port_in_use</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">port</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/dist.py#L72-L80"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.dist.is_port_in_use" title="Permalink to this definition">#</a></dt>
<dd><p>Checks if a port is in use on <cite>localhost</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.dist.DistInfo">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.dist.</span></span><span class="sig-name descname"><span class="pre">DistInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">world_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/dist.py#L84-L116"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.dist.DistInfo" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Contains the environment for the current dist rank.</p>
<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.dist.DistInfo.detect">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">detect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_env</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/dist.py#L92-L116"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.dist.DistInfo.detect" title="Permalink to this definition">#</a></dt>
<dd><p>Tries to automatically detect the pytorch distributed environment paramters.
:rtype: <span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#egrecho.utils.dist.DistInfo" title="egrecho.utils.dist.DistInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistInfo</span></code></a></span></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">allow_env</span> <span class="pre">=</span> <span class="pre">True</span></code>, some other dist environment may be detected.
This detection may not work in processes spawned from the distributed processes (e.g. DataLoader workers)
as the distributed framework wonâ€™t be initialized there.
It will default to 1 distributed process in this case.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.dist.WorkerInfo">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.dist.</span></span><span class="sig-name descname"><span class="pre">WorkerInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_workers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/dist.py#L120-L146"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.dist.WorkerInfo" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Contains the environment for the current dataloader within the current training process.</p>
<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.dist.WorkerInfo.detect">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">detect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allow_env</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/dist.py#L128-L146"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.dist.WorkerInfo.detect" title="Permalink to this definition">#</a></dt>
<dd><p>Automatically detects the number of pytorch workers and the current rank.
:rtype: <span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#egrecho.utils.dist.WorkerInfo" title="egrecho.utils.dist.WorkerInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">WorkerInfo</span></code></a></span></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">allow_env</span> <span class="pre">=</span> <span class="pre">True</span></code>, some other worker environment may be detected.
This only works reliably within a dataloader worker as otherwise the necessary information wonâ€™t be present.
In such a case it will default to 1 worker</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.dist.EnvInfo">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.dist.</span></span><span class="sig-name descname"><span class="pre">EnvInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">worker_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/dist.py#L150-L211"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.dist.EnvInfo" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Container of DistInfo and WorkerInfo.</p>
<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.dist.EnvInfo.from_args">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">world_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">worker_id</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/dist.py#L158-L181"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.dist.EnvInfo.from_args" title="Permalink to this definition">#</a></dt>
<dd><p>Set env info from args.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>world_size</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) -- The worldsize used for distributed training (equals total number of distributed processes)</p></li>
<li><p><strong>rank</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) -- The distributed global rank of the current process</p></li>
<li><p><strong>num_workers</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) -- The number of workers per distributed training process</p></li>
<li><p><strong>worker_id</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) -- The rank of the current worker within the number of workers of
the current training process</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#egrecho.utils.dist.EnvInfo" title="egrecho.utils.dist.EnvInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">EnvInfo</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="egrecho.utils.dist.EnvInfo.num_shards">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_shards</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#egrecho.utils.dist.EnvInfo.num_shards" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the total number of shards.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This may not be accurate in a non-dataloader-worker process like the main training process
as it doesnâ€™t necessarily know about the number of dataloader workers.</p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="egrecho.utils.dist.EnvInfo.shard_rank">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shard_rank</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#egrecho.utils.dist.EnvInfo.shard_rank" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the rank of the current process wrt. the total number of shards.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This may not be accurate in a non-dataloader-worker process like the main training process as it
doesnâ€™t necessarily know about the number of dataloader workers.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.dist.is_global_rank_zero">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.dist.</span></span><span class="sig-name descname"><span class="pre">is_global_rank_zero</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/dist.py#L214-L233"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.dist.is_global_rank_zero" title="Permalink to this definition">#</a></dt>
<dd><p>Helper function to determine if the current process is global_rank 0 (the main process)</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.dist.TorchMPLauncher">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.dist.</span></span><span class="sig-name descname"><span class="pre">TorchMPLauncher</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_processes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">port</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable_mem_share</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spawn'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/dist.py#L236-L382"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.dist.TorchMPLauncher" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Launches processes that run a given function in parallel, and joins them all at the end.</p>
<p>Worker processes gives a rank to <code class="docutils literal notranslate"><span class="pre">os.envrion[&quot;LOCAL_RANK&quot;]</span></code> that ranges from 0 to N - 1.</p>
<p>Referring to <a class="reference external" href="https://github.com/Lightning-AI/lightning/blob/master/src/lightning/fabric/strategies/launchers/multiprocessing.py">lightning fabric</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>This launcher requires all objects to be pickleable.</p></li>
<li><p>Entry point to the program/script should guarded by <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">__name__</span> <span class="pre">==</span> <span class="pre">&quot;__main__&quot;</span></code>.</p></li>
<li><p>In environments like Ipython notebooks where â€˜spawnâ€™ is not available, â€˜forkâ€™ works better.</p></li>
<li><p>Start method â€˜forkâ€™ the user must ensure that no CUDA context gets created in the main process before
the launcher is invoked, i.e., torch.cuda should be uninitialized.</p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_processes</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) -- number works.</p></li>
<li><p><strong>port</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]</span>) -- master port, if not set, will auto find in localhost.</p></li>
<li><p><strong>disable_mem_share</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) -- mem_share is the feature of torch.multiprocessing.
Required set True when running models on CPU, see <code class="xref py py-meth docutils literal notranslate"><span class="pre">_disable_module_memory_sharing()</span></code>.</p></li>
<li><p><strong>start_method</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'spawn'</span></code>, <code class="docutils literal notranslate"><span class="pre">'fork'</span></code>, <code class="docutils literal notranslate"><span class="pre">'forkserver'</span></code>]</span>) -- The method how to start the processes.</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">launcher</span> <span class="o">=</span> <span class="n">TorchMPLauncher</span><span class="p">(</span><span class="n">num_processes</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">launcher</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">my_function</span><span class="p">,</span> <span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">kwarg1</span><span class="o">=</span><span class="n">value1</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.dist.TorchMPLauncher.launch">
<span class="sig-name descname"><span class="pre">launch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/dist.py#L281-L319"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.dist.TorchMPLauncher.launch" title="Permalink to this definition">#</a></dt>
<dd><p>Launches processes that run the given function in parallel.</p>
<p>The function is allowed to have a return value. However, when all processes join, only the return value
of worker process 0 gets returned from this <cite>launch</cite> method in the main process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></span>) -- The entry point for all launched processes.</p></li>
<li><p><strong>*args</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></span>) -- Optional positional arguments to be passed to the given function.</p></li>
<li><p><strong>**kwargs</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></span>) -- Optional keyword arguments to be passed to the given function.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-egrecho.utils.imports">
<span id="egrecho-utils-imports"></span><h1>egrecho.utils.imports<a class="headerlink" href="#module-egrecho.utils.imports" title="Permalink to this heading">#</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.imports.is_package_available">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.imports.</span></span><span class="sig-name descname"><span class="pre">is_package_available</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">modules</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/imports.py#L14-L22"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.imports.is_package_available" title="Permalink to this definition">#</a></dt>
<dd><p>Returns if a top-level module with <code class="xref py py-attr docutils literal notranslate"><span class="pre">name</span></code> exists <strong>without</strong>
importing it. This is generally safer than try-catch block around a
<code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">X</span></code>. It avoids third party libraries breaking assumptions of some of
our tests, e.g., setting multiprocessing start method when imported
(see librosa/#747, torchvision/#544).</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.imports.is_module_available">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.imports.</span></span><span class="sig-name descname"><span class="pre">is_module_available</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#egrecho.utils.imports.is_module_available" title="Permalink to this definition">#</a></dt>
<dd><p>Check if a module path is available in your environment.
This will try to import it.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">is_module_available</span><span class="p">(</span><span class="s1">&#39;torch&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_module_available</span><span class="p">(</span><span class="s1">&#39;fake&#39;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_module_available</span><span class="p">(</span><span class="s1">&#39;torch.utils&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_module_available</span><span class="p">(</span><span class="s1">&#39;torch.util&#39;</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.imports.compare_version">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.imports.</span></span><span class="sig-name descname"><span class="pre">compare_version</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">package</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_base_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/imports.py#L50-L78"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.imports.compare_version" title="Permalink to this definition">#</a></dt>
<dd><p>Compare package version with some requirements.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">compare_version</span><span class="p">(</span><span class="s2">&quot;torch&quot;</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">ge</span><span class="p">,</span> <span class="s2">&quot;0.1&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">compare_version</span><span class="p">(</span><span class="s2">&quot;does_not_exist&quot;</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">ge</span><span class="p">,</span> <span class="s2">&quot;0.0&quot;</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.imports.check_ort_requirements">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.imports.</span></span><span class="sig-name descname"><span class="pre">check_ort_requirements</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#egrecho.utils.imports.check_ort_requirements" title="Permalink to this definition">#</a></dt>
<dd><p>Check onnxruntime is installed and if the installed version match is recent enough</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ImportError</strong> -- If onnxruntime is not installed or too old version is found</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.imports.lazy_import">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.imports.</span></span><span class="sig-name descname"><span class="pre">lazy_import</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/imports.py#L218-L242"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.imports.lazy_import" title="Permalink to this definition">#</a></dt>
<dd><p>Returns a proxy module object that will lazily import the given module the first time it is used.</p>
<p>Copied from <a class="reference external" href="https://github.com/Lightning-AI/utilities/blob/main/src/lightning_utilities/core/imports.py#lazy_import">lightning utilities</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>module_name</strong> -- the fully-qualified module name to import</p></li>
<li><p><strong>callback</strong> (<em>None</em>) -- a callback function to call before importing the
module</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a proxy module object that will be lazily imported when first used</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lazy version of `import tensorflow as tf`</span>
<span class="n">tf</span> <span class="o">=</span> <span class="n">lazy_import</span><span class="p">(</span><span class="s2">&quot;tensorflow&quot;</span><span class="p">)</span>

<span class="c1"># Other commands</span>

<span class="c1"># Now the module is loaded</span>
<span class="n">tf</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.imports.LazyModule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.imports.</span></span><span class="sig-name descname"><span class="pre">LazyModule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/imports.py#L245-L283"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.imports.LazyModule" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">module</span></code></p>
<p>Proxy module that lazily imports the underlying module the first time it is actually used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>module_name</strong> -- the fully-qualified module name to import</p></li>
<li><p><strong>callback</strong> (<em>None</em>) -- a callback function to call before importing the
module</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-egrecho.utils.logging">
<span id="egrecho-utils-logging"></span><h1>egrecho.utils.logging<a class="headerlink" href="#module-egrecho.utils.logging" title="Permalink to this heading">#</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.logging.get_logger">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.logging.</span></span><span class="sig-name descname"><span class="pre">get_logger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'egrecho.utils.logging'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/logging.py#L16-L19"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.logging.get_logger" title="Permalink to this definition">#</a></dt>
<dd><p>Get logger singleton instance based on package name.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#egrecho.utils.logging.Logger" title="egrecho.utils.logging.Logger"><code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.logging.Logger">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.logging.</span></span><span class="sig-name descname"><span class="pre">Logger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/logging.py#L22-L268"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.logging.Logger" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Sigleton pattern for logger.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) -- The name of the logger.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.logging.Logger.set_level">
<span class="sig-name descname"><span class="pre">set_level</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/logging.py#L100-L107"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.logging.Logger.set_level" title="Permalink to this definition">#</a></dt>
<dd><p>Set the logging level</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>level</strong> (<em>str</em>) -- Can only be INFO, DEBUG, WARNING and ERROR.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.logging.Logger.info">
<span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ranks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stack_pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/logging.py#L130-L150"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.logging.Logger.info" title="Permalink to this definition">#</a></dt>
<dd><p>Log an info message.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> (<em>str</em>) -- The message to be logged.</p></li>
<li><p><strong>ranks</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) -- List of parallel ranks.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.logging.Logger.info_once">
<span class="sig-name descname"><span class="pre">info_once</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ranks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/logging.py#L152-L163"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.logging.Logger.info_once" title="Permalink to this definition">#</a></dt>
<dd><p>Log a warning, but only once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) -- Message to display</p></li>
<li><p><strong>ranks</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) -- List of parallel ranks.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.logging.Logger.warning">
<span class="sig-name descname"><span class="pre">warning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ranks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stack_pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/logging.py#L165-L185"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.logging.Logger.warning" title="Permalink to this definition">#</a></dt>
<dd><p>Log a warning message.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> (<em>str</em>) -- The message to be logged.</p></li>
<li><p><strong>ranks</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) -- List of parallel ranks.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.logging.Logger.warning_once">
<span class="sig-name descname"><span class="pre">warning_once</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ranks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/logging.py#L187-L198"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.logging.Logger.warning_once" title="Permalink to this definition">#</a></dt>
<dd><p>Log a warning, but only once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> (<em>str</em>) -- The message to be logged.</p></li>
<li><p><strong>ranks</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) -- List of parallel ranks.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.logging.Logger.debug">
<span class="sig-name descname"><span class="pre">debug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ranks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stack_pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/logging.py#L200-L220"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.logging.Logger.debug" title="Permalink to this definition">#</a></dt>
<dd><p>Log a debug message.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> (<em>str</em>) -- The message to be logged.</p></li>
<li><p><strong>ranks</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) -- List of parallel ranks.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.logging.Logger.error">
<span class="sig-name descname"><span class="pre">error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ranks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stack_pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/logging.py#L222-L242"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.logging.Logger.error" title="Permalink to this definition">#</a></dt>
<dd><p>Log an error message.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> (<em>str</em>) -- The message to be logged.</p></li>
<li><p><strong>ranks</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) -- List of parallel ranks.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.logging.Logger.error_once">
<span class="sig-name descname"><span class="pre">error_once</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ranks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/logging.py#L244-L265"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.logging.Logger.error_once" title="Permalink to this definition">#</a></dt>
<dd><p>Log a error, but only once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> (<em>str</em>) -- The message to be logged.</p></li>
<li><p><strong>ranks</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) -- List of parallel ranks.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-egrecho.utils.mask">
<span id="egrecho-utils-mask"></span><h1>egrecho.utils.mask<a class="headerlink" href="#module-egrecho.utils.mask" title="Permalink to this heading">#</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.mask.subsequent_chunk_mask">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.mask.</span></span><span class="sig-name descname"><span class="pre">subsequent_chunk_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_left_chunks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/mask.py#L9-L43"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.mask.subsequent_chunk_mask" title="Permalink to this definition">#</a></dt>
<dd><p>Create mask for subsequent steps (size, size) with chunk size</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<em>int</em>) -- size of mask</p></li>
<li><p><strong>chunk_size</strong> (<em>int</em>) -- size of chunk</p></li>
<li><p><strong>num_left_chunks</strong> (<em>int</em>) -- number of left chunks
&lt;0: use full chunk
&gt;=0: use num_left_chunks</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) -- â€œcpuâ€ or â€œcudaâ€ or torch.Tensor.device</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>mask</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">subsequent_chunk_mask</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">[[1, 1, 0, 0],</span>
<span class="go"> [1, 1, 0, 0],</span>
<span class="go"> [1, 1, 1, 1],</span>
<span class="go"> [1, 1, 1, 1]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.mask.make_pad_mask">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.mask.</span></span><span class="sig-name descname"><span class="pre">make_pad_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lengths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/mask.py#L46-L71"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.mask.make_pad_mask" title="Permalink to this definition">#</a></dt>
<dd><p>Make mask tensor containing indices of padded part.</p>
<p>See description of make_non_pad_mask.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>lengths</strong> (<em>torch.Tensor</em>) -- Batch of lengths (B,).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mask tensor containing indices of padded part.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.BoolTensor</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lengths</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">make_pad_mask</span><span class="p">(</span><span class="n">lengths</span><span class="p">)</span>
<span class="go">masks = [[0, 0, 0, 0 ,0],</span>
<span class="go">         [0, 0, 0, 1, 1],</span>
<span class="go">         [0, 0, 1, 1, 1]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.mask.make_non_pad_mask">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.mask.</span></span><span class="sig-name descname"><span class="pre">make_non_pad_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lengths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/mask.py#L74-L99"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.mask.make_non_pad_mask" title="Permalink to this definition">#</a></dt>
<dd><p>Make mask tensor containing indices of non-padded part.</p>
<p>The sequences in a batch may have different lengths. To enable
batch computing, padding is need to make all sequence in same
size. To avoid the padding part pass value to context dependent
block such as attention or convolution , this padding part is
masked.</p>
<p>This pad_mask is used in both encoder and decoder.</p>
<p>1 for non-padded part and 0 for padded part.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>lengths</strong> (<em>torch.Tensor</em>) -- Batch of lengths (B,).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>mask tensor containing indices of no padded part.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.BoolTensor</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lengths</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">make_non_pad_mask</span><span class="p">(</span><span class="n">lengths</span><span class="p">)</span>
<span class="go">masks = [[1, 1, 1, 1 ,1],</span>
<span class="go">         [1, 1, 1, 0, 0],</span>
<span class="go">         [1, 1, 0, 0, 0]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.mask.prepare_4d_attention_mask">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.mask.</span></span><span class="sig-name descname"><span class="pre">prepare_4d_attention_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tgt_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/mask.py#L102-L117"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.mask.prepare_4d_attention_mask" title="Permalink to this definition">#</a></dt>
<dd><p>Creates a non-causal 4D mask of shape <cite>(batch_size, 1, query_length, key_value_length)</cite> from a 2D mask of shape
<cite>(batch_size, key_value_length)</cite>. The values in org 2D mask is 0 (no-padded) or 1 (padded).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mask</strong> (<cite>torch.Tensor</cite> or <cite>None</cite>) -- A 2D attention mask of shape <cite>(batch_size, key_value_length)</cite></p></li>
<li><p><strong>dtype</strong> (<cite>torch.dtype</cite>) -- The torch dtype the created mask shall have.</p></li>
<li><p><strong>tgt_len</strong> (<cite>int</cite>) -- The target length or query length the created mask shall have.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.mask.make_causal_mask">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.mask.</span></span><span class="sig-name descname"><span class="pre">make_causal_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_key_values_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sliding_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/mask.py#L136-L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.mask.make_causal_mask" title="Permalink to this definition">#</a></dt>
<dd><p>Creates a causal 4d mask from given querys.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span>) -- inputs query of shape <cite>[bsz, seq_len, â€¦]</cite>.</p></li>
<li><p><strong>dtype</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code></span>) -- the torch dtype the created mask shall have.</p></li>
<li><p><strong>past_key_values_length</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) -- cached past kv length</p></li>
<li><p><strong>sliding_window</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]</span>) -- left chunk size</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>4d attention mask (batch_size, 1, query_length, key_value_length) that can be multiplied with attention scores.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">make_causal_mask</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="go">tensor([[[[ 0.0000e+00, -3.4028e+38, -3.4028e+38],</span>
<span class="go">        [ 0.0000e+00,  0.0000e+00, -3.4028e+38],</span>
<span class="go">        [ 0.0000e+00,  0.0000e+00,  0.0000e+00]]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">make_causal_mask</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">,</span> <span class="n">past_key_values_length</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">tensor([[[[ 0.0000e+00,  0.0000e+00,  0.0000e+00, -3.4028e+38, -3.4028e+38],</span>
<span class="go">        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00, -3.4028e+38],</span>
<span class="go">        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">make_causal_mask</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">,</span> <span class="n">past_key_values_length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sliding_window</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">tensor([[[[ 0.0000e+00,  0.0000e+00,  0.0000e+00, -3.4028e+38, -3.4028e+38],</span>
<span class="go">        [-3.4028e+38,  0.0000e+00,  0.0000e+00,  0.0000e+00, -3.4028e+38],</span>
<span class="go">        [-3.4028e+38, -3.4028e+38,  0.0000e+00,  0.0000e+00,  0.0000e+00]]]])</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-egrecho.utils.misc">
<span id="egrecho-utils-misc"></span><h1>egrecho.utils.misc<a class="headerlink" href="#module-egrecho.utils.misc" title="Permalink to this heading">#</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.misc.parse_bytes">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.misc.</span></span><span class="sig-name descname"><span class="pre">parse_bytes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/misc.py#L69-L76"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.misc.parse_bytes" title="Permalink to this definition">#</a></dt>
<dd><p>parse <cite>size</cite> from bytes to the largest possible unit</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.misc.parse_size">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.misc.</span></span><span class="sig-name descname"><span class="pre">parse_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'abbrev'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/misc.py#L79-L92"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.misc.parse_size" title="Permalink to this definition">#</a></dt>
<dd><p>parse <cite>size</cite> to the largest possible unit.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.misc.kill_name_proc">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.misc.</span></span><span class="sig-name descname"><span class="pre">kill_name_proc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grep_str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_kill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/misc.py#L111-L143"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.misc.kill_name_proc" title="Permalink to this definition">#</a></dt>
<dd><p>Kills processes based on a grep string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grep_str</strong> (<em>str</em>) -- The grep string to search for processes.</p></li>
<li><p><strong>force_kill</strong> (<em>bool</em>) -- If True, uses <code class="docutils literal notranslate"><span class="pre">SIGKILL</span></code> (-9) to forcefully terminate processes.</p></li>
</ul>
</dd>
</dl>
<p>The function uses <code class="docutils literal notranslate"><span class="pre">ps</span> <span class="pre">aux</span> <span class="pre">|</span> <span class="pre">grep</span></code> to search for processes that match the given <code class="docutils literal notranslate"><span class="pre">grep_str</span></code>.
It then requests user confirmation to kill these processes.
If the user agrees, it terminates the processes.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.misc.is_picklable">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.misc.</span></span><span class="sig-name descname"><span class="pre">is_picklable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/misc.py#L187-L195"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.misc.is_picklable" title="Permalink to this definition">#</a></dt>
<dd><p>Tests if an object can be pickled.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.misc.valid_import_clspath">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.misc.</span></span><span class="sig-name descname"><span class="pre">valid_import_clspath</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/misc.py#L198-L203"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.misc.valid_import_clspath" title="Permalink to this definition">#</a></dt>
<dd><p>Import path must be str with dot pattern (<code class="docutils literal notranslate"><span class="pre">'calendar.Calendar'</span></code>).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.misc.class2str">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.misc.</span></span><span class="sig-name descname"><span class="pre">class2str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/misc.py#L206-L218"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.misc.class2str" title="Permalink to this definition">#</a></dt>
<dd><p>Extract path from class type.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">calendar</span><span class="w"> </span><span class="kn">import</span> <span class="n">Calendar</span>
<span class="k">assert</span> <span class="nb">str</span><span class="p">(</span><span class="n">Calendar</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;&lt;class &#39;calendar.Calendar&#39;&gt;&quot;</span>
<span class="k">assert</span> <span class="n">class2str</span><span class="p">(</span><span class="n">Calendar</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;calendar.Calendar&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.misc.get_import_path">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.misc.</span></span><span class="sig-name descname"><span class="pre">get_import_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/misc.py#L222-L259"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.misc.get_import_path" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the shortest dot import path for the given object.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.misc.locate_">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.misc.</span></span><span class="sig-name descname"><span class="pre">locate_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/misc.py#L270-L329"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.misc.locate_" title="Permalink to this definition">#</a></dt>
<dd><p>COPIED FROM <a class="reference external" href="https://github.com/facebookresearch/hydra/blob/f8940600d0ab5c695961ad83abd042ffe9458caf/hydra/_internal/utils.py#L614">Hydra</a>.</p>
<p>Locate an object by name or dotted path, importing as necessary.
This is similar to the pydoc function <code class="docutils literal notranslate"><span class="pre">locate</span></code>, except that it checks for
the module from the given path from back to front.</p>
<p>Behaviours like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;calendar.Calendar&quot;</span>
<span class="n">m</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">mo</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">cl</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">mo</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-egrecho.utils.register">
<span id="egrecho-utils-register"></span><h1>egrecho.utils.register<a class="headerlink" href="#module-egrecho.utils.register" title="Permalink to this heading">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.register.Register">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.register.</span></span><span class="sig-name descname"><span class="pre">Register</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/register.py#L13-L190"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.register.Register" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class is used to register functions or classes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) -- The name of the registry.</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LITTLES</span> <span class="o">=</span> <span class="n">Register</span><span class="p">(</span><span class="s2">&quot;littles&quot;</span><span class="p">)</span>

<span class="nd">@LITTLES</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;litclass&#39;</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">LitClass</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">123</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span>

<span class="ow">or</span>

<span class="n">LITTLES</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">LitClass</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;litclass&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.register.Register.register">
<span class="sig-name descname"><span class="pre">register</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn_or_cls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">override</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">provider_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">metadata</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/register.py#L42-L75"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.register.Register.register" title="Permalink to this definition">#</a></dt>
<dd><p>Adds a function or class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fn_or_cls</strong> (<em>Callable</em>) -- The function to be registered.</p></li>
<li><p><strong>name</strong> (<em>str</em>) -- Name string.</p></li>
<li><p><strong>override</strong> (<em>bool</em>) -- Whether override if exists.</p></li>
<li><p><strong>provider_info</strong> (<em>ProviderInfo</em>) -- infos about provider, which will be merged into metadata.</p></li>
<li><p><strong>**metadata</strong> (<em>dict</em>) -- Additional dict to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.register.Register.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">metadata</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/register.py#L119-L159"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.register.Register.get" title="Permalink to this definition">#</a></dt>
<dd><p>Retrieves functions or classes with key name which has already been registed before.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) -- Name of the registered function.</p></li>
<li><p><strong>with_metadata</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) -- Whether to include the associated metadata in the return value.</p></li>
<li><p><strong>strict</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) -- Whether to return all matches or just one.</p></li>
<li><p><strong>metadata</strong> -- Metadata used to filter against existing registry itemâ€™s metadata.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.register.Register.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/register.py#L161-L163"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.register.Register.keys" title="Permalink to this definition">#</a></dt>
<dd><p>Get all name registred.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.register.ExternalRegister">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.register.</span></span><span class="sig-name descname"><span class="pre">ExternalRegister</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/register.py#L193-L197"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.register.ExternalRegister" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#egrecho.utils.register.Register" title="egrecho.utils.register.Register"><code class="xref py py-class docutils literal notranslate"><span class="pre">Register</span></code></a></p>
<p>TODO</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.register.ConcatRegister">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.register.</span></span><span class="sig-name descname"><span class="pre">ConcatRegister</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">registers</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/register.py#L200-L296"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.register.ConcatRegister" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#egrecho.utils.register.Register" title="egrecho.utils.register.Register"><code class="xref py py-class docutils literal notranslate"><span class="pre">Register</span></code></a></p>
<p>This class is used to concatenate multiple registers.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.register.StrRegister">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.register.</span></span><span class="sig-name descname"><span class="pre">StrRegister</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/register.py#L299-L399"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.register.StrRegister" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Registers multiple strings, which can be used to create alias names.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) -- The name of the registry.</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TOTAL_STEPS</span> <span class="o">=</span> <span class="n">StrRegister</span><span class="p">(</span><span class="s2">&quot;total_steps&quot;</span><span class="p">)</span>

<span class="n">TOTAL_STEPS</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;num_training_steps&quot;</span><span class="p">)</span>

<span class="ow">or</span>

<span class="n">TOTAL_STEPS</span><span class="o">.</span><span class="n">register</span><span class="p">([</span><span class="s2">&quot;num_training_steps&quot;</span><span class="p">,])</span>

<span class="k">assert</span> <span class="n">TOTAL_STEPS</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;total_steps&quot;</span><span class="p">,</span><span class="s2">&quot;num_training_steps&quot;</span><span class="p">]</span>
<span class="k">assert</span> <span class="s2">&quot;num_training_steps&quot;</span> <span class="ow">in</span> <span class="n">TOTAL_STEPS</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.register.StrRegister.register">
<span class="sig-name descname"><span class="pre">register</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">str_or_strs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/register.py#L329-L347"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.register.StrRegister.register" title="Permalink to this definition">#</a></dt>
<dd><p>Adds a string or sequence of strings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>str_or_strs</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>]</span>) -- String(s) to be registed.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.register.StrRegister.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/register.py#L370-L372"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.register.StrRegister.keys" title="Permalink to this definition">#</a></dt>
<dd><p>Get all name registred.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.register.ConcatStrRegister">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.register.</span></span><span class="sig-name descname"><span class="pre">ConcatStrRegister</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">registers</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/register.py#L402-L443"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.register.ConcatStrRegister" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#egrecho.utils.register.StrRegister" title="egrecho.utils.register.StrRegister"><code class="xref py py-class docutils literal notranslate"><span class="pre">StrRegister</span></code></a></p>
<p>This class is used to concatenate multiple registers.</p>
</dd></dl>

</section>
<section id="module-egrecho.utils.torch_utils">
<span id="egrecho-utils-torch-utils"></span><h1>egrecho.utils.torch_utils<a class="headerlink" href="#module-egrecho.utils.torch_utils" title="Permalink to this heading">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.torch_utils.RandomValue">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">RandomValue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/torch_utils.py#L13-L38"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.torch_utils.RandomValue" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Generate a uniform distribution in the range <code class="docutils literal notranslate"><span class="pre">[start,</span> <span class="pre">end]</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.torch_utils.batch_pad_right">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">batch_pad_right</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/torch_utils.py#L42-L96"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.torch_utils.batch_pad_right" title="Permalink to this definition">#</a></dt>
<dd><p>Given a list of torch tensors it batches them together by padding to the right
on each dimension in order to get same length for all.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensors</strong> (<em>list</em>) -- List of tensor we wish to pad together.</p></li>
<li><p><strong>mode</strong> (<em>str</em>) -- Padding mode see torch.nn.functional.pad documentation.</p></li>
<li><p><strong>value</strong> (<em>float</em>) -- Padding value see torch.nn.functional.pad documentation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>tensor</strong> (<em>torch.Tensor</em>) -- Padded tensor.</p></li>
<li><p><strong>valid_vals</strong> (<em>list</em>) -- List containing proportion for each dimension of original, non-padded values.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.torch_utils.pad_right_to">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">pad_right_to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/torch_utils.py#L99-L143"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.torch_utils.pad_right_to" title="Permalink to this definition">#</a></dt>
<dd><p>This function takes a torch tensor of arbitrary shape and pads it to target
shape by appending values on the right.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor</strong> (<em>input torch tensor</em>) -- Input tensor whose dimension we need to pad.</p></li>
<li><p><strong>target_shape</strong> (<em>(</em><em>list</em><em>, </em><em>tuple</em><em>)</em>) -- Target shape we want for the target tensor its len must be equal to tensor.ndim</p></li>
<li><p><strong>mode</strong> (<em>str</em>) -- Pad mode, please refer to torch.nn.functional.pad documentation.</p></li>
<li><p><strong>value</strong> (<em>float</em>) -- Pad value, please refer to torch.nn.functional.pad documentation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>tensor</strong> (<em>torch.Tensor</em>) -- Padded tensor.</p></li>
<li><p><strong>valid_vals</strong> (<em>list</em>) -- List containing proportion for each dimension of original, non-padded values.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.torch_utils.audio_collate_fn">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">audio_collate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">waveforms</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/torch_utils.py#L146-L158"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.torch_utils.audio_collate_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Pad a list of waves with shape <cite>(â€¦, T)</cite>, returns a tuple containing tensor and a list of its lengths.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.torch_utils.is_numpy_array">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">is_numpy_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/torch_utils.py#L161-L165"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.torch_utils.is_numpy_array" title="Permalink to this definition">#</a></dt>
<dd><p>Tests if <cite>x</cite> is a numpy array or not.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.torch_utils.infer_framework_from_repr">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">infer_framework_from_repr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/torch_utils.py#L172-L181"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.torch_utils.infer_framework_from_repr" title="Permalink to this definition">#</a></dt>
<dd><p>Tries to guess the framework of an object <cite>x</cite> from its repr (brittle but will help in <cite>is_tensor</cite> to try the
frameworks in a smart order, without the need to import the frameworks).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.torch_utils.to_py_obj">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">to_py_obj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/torch_utils.py#L204-L229"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.torch_utils.to_py_obj" title="Permalink to this definition">#</a></dt>
<dd><p>Convert a TensorFlow tensor, PyTorch tensor, Numpy array or python list to a python list.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.torch_utils.to_numpy">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">to_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/torch_utils.py#L232-L243"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.torch_utils.to_numpy" title="Permalink to this definition">#</a></dt>
<dd><p>Convert a  PyTorch tensor, Numpy array or python list to a Numpy array.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="egrecho.utils.torch_utils.save_dislike_batch">
<span class="sig-prename descclassname"><span class="pre">egrecho.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">save_dislike_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exstr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/torch_utils.py#L276-L292"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.torch_utils.save_dislike_batch" title="Permalink to this definition">#</a></dt>
<dd><p>Save the dislike batch into disk. Might use this to debug.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-egrecho.utils.types">
<span id="egrecho-utils-types"></span><h1>egrecho.utils.types<a class="headerlink" href="#module-egrecho.utils.types" title="Permalink to this heading">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.types.ModelOutput">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.types.</span></span><span class="sig-name descname"><span class="pre">ModelOutput</span></span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/types.py#L17-L134"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.types.ModelOutput" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code></p>
<p>Base class for all model outputs as dataclass. Copied from <a class="reference external" href="https://github.com/huggingface/transformers/blob/main/src/transformers/utils/generic.py#ModelOutput">huggingface modelout</a>.</p>
<p>Has a <code class="xref py py-meth docutils literal notranslate"><span class="pre">__getitem__()</span></code> that allows indexing by integer or slice (like a
tuple) or strings (like a dictionary) that will ignore the <cite>None</cite> attributes. Otherwise behaves like a regular
python dictionary.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You canâ€™t unpack a <cite>ModelOutput</cite> directly. Use the [<cite>ModelOutput.to_tuple</cite>] method to convert it to a tuple
before.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.types.ModelOutput.setdefault">
<span class="sig-name descname"><span class="pre">setdefault</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/types.py#L93-L97"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.types.ModelOutput.setdefault" title="Permalink to this definition">#</a></dt>
<dd><p>remove this action</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.types.ModelOutput.pop">
<span class="sig-name descname"><span class="pre">pop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/types.py#L99-L103"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.types.ModelOutput.pop" title="Permalink to this definition">#</a></dt>
<dd><p>remove this action</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.types.ModelOutput.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/types.py#L105-L109"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.types.ModelOutput.update" title="Permalink to this definition">#</a></dt>
<dd><p>remove this action</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.types.ModelOutput.to_tuple">
<span class="sig-name descname"><span class="pre">to_tuple</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/types.py#L130-L134"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.types.ModelOutput.to_tuple" title="Permalink to this definition">#</a></dt>
<dd><p>Convert self to a tuple containing all the attributes/keys that are not <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]</span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.types.SingletonMeta">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.types.</span></span><span class="sig-name descname"><span class="pre">SingletonMeta</span></span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/types.py#L141-L157"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.types.SingletonMeta" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">type</span></code></p>
<p>A metaclass for creating singleton classes.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.types.StrEnum">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.types.</span></span><span class="sig-name descname"><span class="pre">StrEnum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/types.py#L161-L274"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.types.StrEnum" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<p>Type of any enumerator with allowed comparison to string invariant to cases.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">MySE</span><span class="p">(</span><span class="n">StrEnum</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">t1</span> <span class="o">=</span> <span class="s2">&quot;T-1&quot;</span>
<span class="gp">... </span>    <span class="n">t2</span> <span class="o">=</span> <span class="s2">&quot;T-2&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MySE</span><span class="p">(</span><span class="s2">&quot;T-1&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">MySE</span><span class="o">.</span><span class="n">t1</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MySE</span><span class="o">.</span><span class="n">from_str</span><span class="p">(</span><span class="s2">&quot;t-2&quot;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">MySE</span><span class="o">.</span><span class="n">t2</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MySE</span><span class="o">.</span><span class="n">from_str</span><span class="p">(</span><span class="s2">&quot;t-2&quot;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
<span class="go">&lt;MySE.t2: &#39;T-2&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MySE</span><span class="o">.</span><span class="n">from_str</span><span class="p">(</span><span class="s2">&quot;t-3&quot;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;any&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">  </span><span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Invalid match: expected one of [&#39;t1&#39;, &#39;t2&#39;, &#39;T-1&#39;, &#39;T-2&#39;], but got t-3.</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.types.StrEnum.from_str">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'key'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/types.py#L186-L214"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.types.StrEnum.from_str" title="Permalink to this definition">#</a></dt>
<dd><p>Create <code class="docutils literal notranslate"><span class="pre">StrEnum</span></code> from a string matching the key or value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) -- matching string</p></li>
<li><p><strong>source</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'key'</span></code>, <code class="docutils literal notranslate"><span class="pre">'value'</span></code>, <code class="docutils literal notranslate"><span class="pre">'any'</span></code>]</span>) -- <p>compare with:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;key&quot;</span></code>: validates only from the enum keys, typical alphanumeric with â€œ_â€</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;value&quot;</span></code>: validates only from the values, could be any string</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;any&quot;</span></code>: validates with any key or value, but key has priority</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> -- if requested string does not match any option based on selected source.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#egrecho.utils.types.StrEnum" title="egrecho.utils.types.StrEnum"><code class="xref py py-class docutils literal notranslate"><span class="pre">StrEnum</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="egrecho.utils.types.StrEnum.try_from_str">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">try_from_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'key'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/types.py#L216-L229"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.types.StrEnum.try_from_str" title="Permalink to this definition">#</a></dt>
<dd><p>Try to create emun and if it does not match any, return <cite>None</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="#egrecho.utils.types.StrEnum" title="egrecho.utils.types.StrEnum"><code class="xref py py-class docutils literal notranslate"><span class="pre">StrEnum</span></code></a>]</span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.types.Split">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.types.</span></span><span class="sig-name descname"><span class="pre">Split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/types.py#L277-L289"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.types.Split" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#egrecho.utils.types.StrEnum" title="egrecho.utils.types.StrEnum"><code class="xref py py-class docutils literal notranslate"><span class="pre">StrEnum</span></code></a></p>
<p>Contains Enums of split.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.types.FilterType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.types.</span></span><span class="sig-name descname"><span class="pre">FilterType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/types.py#L292-L297"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.types.FilterType" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#egrecho.utils.types.StrEnum" title="egrecho.utils.types.StrEnum"><code class="xref py py-class docutils literal notranslate"><span class="pre">StrEnum</span></code></a></p>
<p>Filt strategy when dict dumps.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.types.PaddingStrategy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.types.</span></span><span class="sig-name descname"><span class="pre">PaddingStrategy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/types.py#L300-L308"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.types.PaddingStrategy" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#egrecho.utils.types.StrEnum" title="egrecho.utils.types.StrEnum"><code class="xref py py-class docutils literal notranslate"><span class="pre">StrEnum</span></code></a></p>
<p>Possible values for the <cite>padding</cite> argument. Useful for tab-completion in an
IDE.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="egrecho.utils.types.InitWeightType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">egrecho.utils.types.</span></span><span class="sig-name descname"><span class="pre">InitWeightType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wangers/subtools2/tree/master/egrecho/utils/types.py#L314-L316"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#egrecho.utils.types.InitWeightType" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#egrecho.utils.types.StrEnum" title="egrecho.utils.types.StrEnum"><code class="xref py py-class docutils literal notranslate"><span class="pre">StrEnum</span></code></a></p>
<p>An enumeration.</p>
</dd></dl>

</section>
<section id="egrecho-utils-dummy">
<h1>egrecho.utils.dummy<a class="headerlink" href="#egrecho-utils-dummy" title="Permalink to this heading">#</a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="egrecho.utils.dummy.html">egrecho.utils.dummy.generate</a></li>
</ul>
</div>
</section>
<section id="egrecho-utils-io">
<h1>egrecho.utils.io<a class="headerlink" href="#egrecho-utils-io" title="Permalink to this heading">#</a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="egrecho.utils.io.html">egrecho.utils.io.files</a></li>
<li class="toctree-l1"><a class="reference internal" href="egrecho.utils.io.html#module-egrecho.utils.io.kaldi">egrecho.utils.io.kaldi</a></li>
<li class="toctree-l1"><a class="reference internal" href="egrecho.utils.io.html#module-egrecho.utils.io.reader">egrecho.utils.io.reader</a></li>
<li class="toctree-l1"><a class="reference internal" href="egrecho.utils.io.html#module-egrecho.utils.io.resolve_ckpt">egrecho.utils.io.resolve_ckpt</a></li>
<li class="toctree-l1"><a class="reference internal" href="egrecho.utils.io.html#module-egrecho.utils.io.utils">egrecho.utils.io.utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="egrecho.utils.io.html#module-egrecho.utils.io.writer">egrecho.utils.io.writer</a></li>
</ul>
</div>
</section>
<section id="egrecho-utils-patch">
<h1>egrecho.utils.patch<a class="headerlink" href="#egrecho-utils-patch" title="Permalink to this heading">#</a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="egrecho.utils.patch.html">egrecho.utils.patch.io_patch</a></li>
<li class="toctree-l1"><a class="reference internal" href="egrecho.utils.patch.html#module-egrecho.utils.patch.torchdata_patch">egrecho.utils.patch.torchdata_patch</a></li>
<li class="toctree-l1"><a class="reference internal" href="egrecho.utils.patch.html#egrecho-utils-patch-simple-parse-patch">egrecho.utils.patch.simple_parse_patch</a></li>
</ul>
</div>
</section>
<section id="egrecho-utils-seeder">
<h1>egrecho.utils.seeder<a class="headerlink" href="#egrecho-utils-seeder" title="Permalink to this heading">#</a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="egrecho.utils.seeder.html">egrecho.utils.seeder.seed</a></li>
</ul>
</div>
</section>
<section id="egrecho-utils-text">
<h1>egrecho.utils.text<a class="headerlink" href="#egrecho-utils-text" title="Permalink to this heading">#</a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="egrecho.utils.text.html">egrecho.utils.text.cleaners</a></li>
<li class="toctree-l1"><a class="reference internal" href="egrecho.utils.text.html#module-egrecho.utils.text.number_cn">egrecho.utils.text.number_cn</a></li>
</ul>
</div>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="egrecho.utils.dummy.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">egrecho.utils.dummy.generate</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../core/tokenizer.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">egrecho.core.tokenizer</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Dexin Liao
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">egrecho.utils.apply</a><ul>
<li><a class="reference internal" href="#egrecho.utils.apply.apply_to_collection"><code class="docutils literal notranslate"><span class="pre">apply_to_collection()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-egrecho.utils.common">egrecho.utils.common</a><ul>
<li><a class="reference internal" href="#egrecho.utils.common.alt_none"><code class="docutils literal notranslate"><span class="pre">alt_none()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.common.is_in_range"><code class="docutils literal notranslate"><span class="pre">is_in_range()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.common.ObjectDict"><code class="docutils literal notranslate"><span class="pre">ObjectDict</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.common.DataclassSerialMixin"><code class="docutils literal notranslate"><span class="pre">DataclassSerialMixin</span></code></a><ul>
<li><a class="reference internal" href="#egrecho.utils.common.DataclassSerialMixin.to_dict"><code class="docutils literal notranslate"><span class="pre">DataclassSerialMixin.to_dict()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.common.DataclassSerialMixin.from_dict"><code class="docutils literal notranslate"><span class="pre">DataclassSerialMixin.from_dict()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#egrecho.utils.common.GenericSerialMixin"><code class="docutils literal notranslate"><span class="pre">GenericSerialMixin</span></code></a><ul>
<li><a class="reference internal" href="#egrecho.utils.common.GenericSerialMixin.to_dict"><code class="docutils literal notranslate"><span class="pre">GenericSerialMixin.to_dict()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.common.GenericSerialMixin.from_dict"><code class="docutils literal notranslate"><span class="pre">GenericSerialMixin.from_dict()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#egrecho.utils.common.SaveLoadMixin"><code class="docutils literal notranslate"><span class="pre">SaveLoadMixin</span></code></a><ul>
<li><a class="reference internal" href="#egrecho.utils.common.SaveLoadMixin.fetch_from"><code class="docutils literal notranslate"><span class="pre">SaveLoadMixin.fetch_from()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#egrecho.utils.common.fields_init_var"><code class="docutils literal notranslate"><span class="pre">fields_init_var()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.common.batched"><code class="docutils literal notranslate"><span class="pre">batched()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.common.camelcase_to_snakecase"><code class="docutils literal notranslate"><span class="pre">camelcase_to_snakecase()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.common.snakecase_to_camelcase"><code class="docutils literal notranslate"><span class="pre">snakecase_to_camelcase()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.common.get_diff_dict"><code class="docutils literal notranslate"><span class="pre">get_diff_dict()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.common.del_default_dict"><code class="docutils literal notranslate"><span class="pre">del_default_dict()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.common.dict_union"><code class="docutils literal notranslate"><span class="pre">dict_union()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.common.list2tuple"><code class="docutils literal notranslate"><span class="pre">list2tuple()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.common.omegaconf_handler"><code class="docutils literal notranslate"><span class="pre">omegaconf_handler()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-egrecho.utils.constants">egrecho.utils.constants</a></li>
<li><a class="reference internal" href="#module-egrecho.utils.cuda_utils">egrecho.utils.cuda_utils</a><ul>
<li><a class="reference internal" href="#egrecho.utils.cuda_utils.avoid_float16_autocast_context"><code class="docutils literal notranslate"><span class="pre">avoid_float16_autocast_context()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.cuda_utils.maybe_set_cuda_expandable_segments"><code class="docutils literal notranslate"><span class="pre">maybe_set_cuda_expandable_segments()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.cuda_utils.set_to_cuda"><code class="docutils literal notranslate"><span class="pre">set_to_cuda()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.cuda_utils.get_current_device"><code class="docutils literal notranslate"><span class="pre">get_current_device()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.cuda_utils.to_device"><code class="docutils literal notranslate"><span class="pre">to_device()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.cuda_utils.parse_gpus"><code class="docutils literal notranslate"><span class="pre">parse_gpus()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.cuda_utils.parse_gpus_opt"><code class="docutils literal notranslate"><span class="pre">parse_gpus_opt()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.cuda_utils.parse_gpu_id"><code class="docutils literal notranslate"><span class="pre">parse_gpu_id()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.cuda_utils.synchronize"><code class="docutils literal notranslate"><span class="pre">synchronize()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.cuda_utils.peak_cuda_memory"><code class="docutils literal notranslate"><span class="pre">peak_cuda_memory()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.cuda_utils.release_memory"><code class="docutils literal notranslate"><span class="pre">release_memory()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.cuda_utils.AutoGPUMode"><code class="docutils literal notranslate"><span class="pre">AutoGPUMode</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.cuda_utils.GPUManager"><code class="docutils literal notranslate"><span class="pre">GPUManager</span></code></a><ul>
<li><a class="reference internal" href="#egrecho.utils.cuda_utils.GPUManager.new_query"><code class="docutils literal notranslate"><span class="pre">GPUManager.new_query()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.cuda_utils.GPUManager.detect"><code class="docutils literal notranslate"><span class="pre">GPUManager.detect()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.cuda_utils.GPUManager.auto_choice"><code class="docutils literal notranslate"><span class="pre">GPUManager.auto_choice()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#egrecho.utils.cuda_utils.device2gpu_id"><code class="docutils literal notranslate"><span class="pre">device2gpu_id()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.cuda_utils.num_gpus"><code class="docutils literal notranslate"><span class="pre">num_gpus()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.cuda_utils.is_cuda_available"><code class="docutils literal notranslate"><span class="pre">is_cuda_available()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.cuda_utils.patch_nvml_check_env"><code class="docutils literal notranslate"><span class="pre">patch_nvml_check_env()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.cuda_utils.NVMLDeviceCount"><code class="docutils literal notranslate"><span class="pre">NVMLDeviceCount</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-egrecho.utils.data_utils">egrecho.utils.data_utils</a><ul>
<li><a class="reference internal" href="#egrecho.utils.data_utils.split_sequence"><code class="docutils literal notranslate"><span class="pre">split_sequence()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.data_utils.Dillable"><code class="docutils literal notranslate"><span class="pre">Dillable</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.data_utils.iflatmap_unordered"><code class="docutils literal notranslate"><span class="pre">iflatmap_unordered()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.data_utils.buffer_shuffle"><code class="docutils literal notranslate"><span class="pre">buffer_shuffle()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.data_utils.ichunk_size"><code class="docutils literal notranslate"><span class="pre">ichunk_size()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.data_utils.ilen"><code class="docutils literal notranslate"><span class="pre">ilen()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.data_utils.zip_dict"><code class="docutils literal notranslate"><span class="pre">zip_dict()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.data_utils.ClassLabel"><code class="docutils literal notranslate"><span class="pre">ClassLabel</span></code></a><ul>
<li><a class="reference internal" href="#egrecho.utils.data_utils.ClassLabel.str2int"><code class="docutils literal notranslate"><span class="pre">ClassLabel.str2int()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.data_utils.ClassLabel.int2str"><code class="docutils literal notranslate"><span class="pre">ClassLabel.int2str()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.data_utils.ClassLabel.from_dict"><code class="docutils literal notranslate"><span class="pre">ClassLabel.from_dict()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.data_utils.ClassLabel.to_file"><code class="docutils literal notranslate"><span class="pre">ClassLabel.to_file()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#egrecho.utils.data_utils.VSORT"><code class="docutils literal notranslate"><span class="pre">VSORT</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.data_utils.count_vocab_from_iterator"><code class="docutils literal notranslate"><span class="pre">count_vocab_from_iterator()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.data_utils.build_vocab_from_iterator"><code class="docutils literal notranslate"><span class="pre">build_vocab_from_iterator()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.data_utils.SplitInfo"><code class="docutils literal notranslate"><span class="pre">SplitInfo</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.data_utils.try_length"><code class="docutils literal notranslate"><span class="pre">try_length()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.data_utils.wavscp2dicts"><code class="docutils literal notranslate"><span class="pre">wavscp2dicts()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-egrecho.utils.dist">egrecho.utils.dist</a><ul>
<li><a class="reference internal" href="#egrecho.utils.dist.send_exit_ddp"><code class="docutils literal notranslate"><span class="pre">send_exit_ddp()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.dist.get_free_port"><code class="docutils literal notranslate"><span class="pre">get_free_port()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.dist.is_port_in_use"><code class="docutils literal notranslate"><span class="pre">is_port_in_use()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.dist.DistInfo"><code class="docutils literal notranslate"><span class="pre">DistInfo</span></code></a><ul>
<li><a class="reference internal" href="#egrecho.utils.dist.DistInfo.detect"><code class="docutils literal notranslate"><span class="pre">DistInfo.detect()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#egrecho.utils.dist.WorkerInfo"><code class="docutils literal notranslate"><span class="pre">WorkerInfo</span></code></a><ul>
<li><a class="reference internal" href="#egrecho.utils.dist.WorkerInfo.detect"><code class="docutils literal notranslate"><span class="pre">WorkerInfo.detect()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#egrecho.utils.dist.EnvInfo"><code class="docutils literal notranslate"><span class="pre">EnvInfo</span></code></a><ul>
<li><a class="reference internal" href="#egrecho.utils.dist.EnvInfo.from_args"><code class="docutils literal notranslate"><span class="pre">EnvInfo.from_args()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.dist.EnvInfo.num_shards"><code class="docutils literal notranslate"><span class="pre">EnvInfo.num_shards</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.dist.EnvInfo.shard_rank"><code class="docutils literal notranslate"><span class="pre">EnvInfo.shard_rank</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#egrecho.utils.dist.is_global_rank_zero"><code class="docutils literal notranslate"><span class="pre">is_global_rank_zero()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.dist.TorchMPLauncher"><code class="docutils literal notranslate"><span class="pre">TorchMPLauncher</span></code></a><ul>
<li><a class="reference internal" href="#egrecho.utils.dist.TorchMPLauncher.launch"><code class="docutils literal notranslate"><span class="pre">TorchMPLauncher.launch()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-egrecho.utils.imports">egrecho.utils.imports</a><ul>
<li><a class="reference internal" href="#egrecho.utils.imports.is_package_available"><code class="docutils literal notranslate"><span class="pre">is_package_available()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.imports.is_module_available"><code class="docutils literal notranslate"><span class="pre">is_module_available()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.imports.compare_version"><code class="docutils literal notranslate"><span class="pre">compare_version()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.imports.check_ort_requirements"><code class="docutils literal notranslate"><span class="pre">check_ort_requirements()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.imports.lazy_import"><code class="docutils literal notranslate"><span class="pre">lazy_import()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.imports.LazyModule"><code class="docutils literal notranslate"><span class="pre">LazyModule</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-egrecho.utils.logging">egrecho.utils.logging</a><ul>
<li><a class="reference internal" href="#egrecho.utils.logging.get_logger"><code class="docutils literal notranslate"><span class="pre">get_logger()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.logging.Logger"><code class="docutils literal notranslate"><span class="pre">Logger</span></code></a><ul>
<li><a class="reference internal" href="#egrecho.utils.logging.Logger.set_level"><code class="docutils literal notranslate"><span class="pre">Logger.set_level()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.logging.Logger.info"><code class="docutils literal notranslate"><span class="pre">Logger.info()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.logging.Logger.info_once"><code class="docutils literal notranslate"><span class="pre">Logger.info_once()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.logging.Logger.warning"><code class="docutils literal notranslate"><span class="pre">Logger.warning()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.logging.Logger.warning_once"><code class="docutils literal notranslate"><span class="pre">Logger.warning_once()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.logging.Logger.debug"><code class="docutils literal notranslate"><span class="pre">Logger.debug()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.logging.Logger.error"><code class="docutils literal notranslate"><span class="pre">Logger.error()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.logging.Logger.error_once"><code class="docutils literal notranslate"><span class="pre">Logger.error_once()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-egrecho.utils.mask">egrecho.utils.mask</a><ul>
<li><a class="reference internal" href="#egrecho.utils.mask.subsequent_chunk_mask"><code class="docutils literal notranslate"><span class="pre">subsequent_chunk_mask()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.mask.make_pad_mask"><code class="docutils literal notranslate"><span class="pre">make_pad_mask()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.mask.make_non_pad_mask"><code class="docutils literal notranslate"><span class="pre">make_non_pad_mask()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.mask.prepare_4d_attention_mask"><code class="docutils literal notranslate"><span class="pre">prepare_4d_attention_mask()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.mask.make_causal_mask"><code class="docutils literal notranslate"><span class="pre">make_causal_mask()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-egrecho.utils.misc">egrecho.utils.misc</a><ul>
<li><a class="reference internal" href="#egrecho.utils.misc.parse_bytes"><code class="docutils literal notranslate"><span class="pre">parse_bytes()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.misc.parse_size"><code class="docutils literal notranslate"><span class="pre">parse_size()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.misc.kill_name_proc"><code class="docutils literal notranslate"><span class="pre">kill_name_proc()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.misc.is_picklable"><code class="docutils literal notranslate"><span class="pre">is_picklable()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.misc.valid_import_clspath"><code class="docutils literal notranslate"><span class="pre">valid_import_clspath()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.misc.class2str"><code class="docutils literal notranslate"><span class="pre">class2str()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.misc.get_import_path"><code class="docutils literal notranslate"><span class="pre">get_import_path()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.misc.locate_"><code class="docutils literal notranslate"><span class="pre">locate_()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-egrecho.utils.register">egrecho.utils.register</a><ul>
<li><a class="reference internal" href="#egrecho.utils.register.Register"><code class="docutils literal notranslate"><span class="pre">Register</span></code></a><ul>
<li><a class="reference internal" href="#egrecho.utils.register.Register.register"><code class="docutils literal notranslate"><span class="pre">Register.register()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.register.Register.get"><code class="docutils literal notranslate"><span class="pre">Register.get()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.register.Register.keys"><code class="docutils literal notranslate"><span class="pre">Register.keys()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#egrecho.utils.register.ExternalRegister"><code class="docutils literal notranslate"><span class="pre">ExternalRegister</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.register.ConcatRegister"><code class="docutils literal notranslate"><span class="pre">ConcatRegister</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.register.StrRegister"><code class="docutils literal notranslate"><span class="pre">StrRegister</span></code></a><ul>
<li><a class="reference internal" href="#egrecho.utils.register.StrRegister.register"><code class="docutils literal notranslate"><span class="pre">StrRegister.register()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.register.StrRegister.keys"><code class="docutils literal notranslate"><span class="pre">StrRegister.keys()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#egrecho.utils.register.ConcatStrRegister"><code class="docutils literal notranslate"><span class="pre">ConcatStrRegister</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-egrecho.utils.torch_utils">egrecho.utils.torch_utils</a><ul>
<li><a class="reference internal" href="#egrecho.utils.torch_utils.RandomValue"><code class="docutils literal notranslate"><span class="pre">RandomValue</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.torch_utils.batch_pad_right"><code class="docutils literal notranslate"><span class="pre">batch_pad_right()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.torch_utils.pad_right_to"><code class="docutils literal notranslate"><span class="pre">pad_right_to()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.torch_utils.audio_collate_fn"><code class="docutils literal notranslate"><span class="pre">audio_collate_fn()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.torch_utils.is_numpy_array"><code class="docutils literal notranslate"><span class="pre">is_numpy_array()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.torch_utils.infer_framework_from_repr"><code class="docutils literal notranslate"><span class="pre">infer_framework_from_repr()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.torch_utils.to_py_obj"><code class="docutils literal notranslate"><span class="pre">to_py_obj()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.torch_utils.to_numpy"><code class="docutils literal notranslate"><span class="pre">to_numpy()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.torch_utils.save_dislike_batch"><code class="docutils literal notranslate"><span class="pre">save_dislike_batch()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-egrecho.utils.types">egrecho.utils.types</a><ul>
<li><a class="reference internal" href="#egrecho.utils.types.ModelOutput"><code class="docutils literal notranslate"><span class="pre">ModelOutput</span></code></a><ul>
<li><a class="reference internal" href="#egrecho.utils.types.ModelOutput.setdefault"><code class="docutils literal notranslate"><span class="pre">ModelOutput.setdefault()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.types.ModelOutput.pop"><code class="docutils literal notranslate"><span class="pre">ModelOutput.pop()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.types.ModelOutput.update"><code class="docutils literal notranslate"><span class="pre">ModelOutput.update()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.types.ModelOutput.to_tuple"><code class="docutils literal notranslate"><span class="pre">ModelOutput.to_tuple()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#egrecho.utils.types.SingletonMeta"><code class="docutils literal notranslate"><span class="pre">SingletonMeta</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.types.StrEnum"><code class="docutils literal notranslate"><span class="pre">StrEnum</span></code></a><ul>
<li><a class="reference internal" href="#egrecho.utils.types.StrEnum.from_str"><code class="docutils literal notranslate"><span class="pre">StrEnum.from_str()</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.types.StrEnum.try_from_str"><code class="docutils literal notranslate"><span class="pre">StrEnum.try_from_str()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#egrecho.utils.types.Split"><code class="docutils literal notranslate"><span class="pre">Split</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.types.FilterType"><code class="docutils literal notranslate"><span class="pre">FilterType</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.types.PaddingStrategy"><code class="docutils literal notranslate"><span class="pre">PaddingStrategy</span></code></a></li>
<li><a class="reference internal" href="#egrecho.utils.types.InitWeightType"><code class="docutils literal notranslate"><span class="pre">InitWeightType</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#egrecho-utils-dummy">egrecho.utils.dummy</a></li>
<li><a class="reference internal" href="#egrecho-utils-io">egrecho.utils.io</a></li>
<li><a class="reference internal" href="#egrecho-utils-patch">egrecho.utils.patch</a></li>
<li><a class="reference internal" href="#egrecho-utils-seeder">egrecho.utils.seeder</a></li>
<li><a class="reference internal" href="#egrecho-utils-text">egrecho.utils.text</a></li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=b3ba4146"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=4ea706d9"></script>
    <script src="../../_static/tabs.js?v=3ee01567"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    </body>
</html>